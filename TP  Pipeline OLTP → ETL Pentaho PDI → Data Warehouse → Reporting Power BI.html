<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TP : Pipeline OLTP ‚Üí ETL Pentaho PDI ‚Üí Data Warehouse ‚Üí Reporting Power BI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        h1 {
            color: #1a73e8;
            font-size: 2.2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #1a73e8;
            padding-bottom: 15px;
        }

        h2 {
            color: #0d6efd;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 5px solid #0d6efd;
        }

        h3 {
            color: #495057;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 12px;
        }

        h4 {
            color: #6c757d;
            font-size: 1.1em;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        pre {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: #212529;
            font-size: 0.85em;
            line-height: 1.5;
        }

        .note {
            background-color: #e7f3ff;
            border-left: 5px solid #1a73e8;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning {
            background-color: #fff9e6;
            border-left: 5px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success {
            background-color: #e8f5e9;
            border-left: 5px solid #28a745;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        th {
            background-color: #1a73e8;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:hover {
            background-color: #e9ecef;
        }

        .step {
            background-color: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .step-number {
            font-weight: bold;
            color: #28a745;
            font-size: 1.1em;
        }

        strong {
            color: #1a73e8;
        }

        .intro {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .intro h1 {
            color: white;
            border-bottom: 3px solid white;
        }

        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
    <div class="container">
        <div class="intro">
            <h1>TP : Pipeline OLTP ‚Üí ETL Pentaho PDI ‚Üí Data Warehouse ‚Üí Reporting Power BI</h1>
            <p style="font-size: 1.1em; margin-top: 15px;">Un TP complet et d√©taill√© pour ma√Ætriser la cha√Æne compl√®te de Business Intelligence</p>
        </div>

        <h2>Introduction</h2>
        
        <p>Ce TP complet  vous guidera √† travers l'ensemble du processus de Business Intelligence moderne.</p>

        <h3>üîπ OLTP vs OLAP : Comprendre la diff√©rence</h3>
        
        <p><strong>OLTP (Online Transaction Processing)</strong> : Il s'agit de syst√®mes optimis√©s pour g√©rer les op√©rations quotidiennes d'une entreprise. Ces bases de donn√©es sont normalis√©es (3FN) pour √©viter la redondance et garantir l'int√©grit√© des donn√©es. Elles supportent un grand nombre de transactions courtes (INSERT, UPDATE, DELETE) comme l'enregistrement d'une commande client ou la mise √† jour d'un stock.</p>

        <p><strong>OLAP (Online Analytical Processing)</strong> : Ces syst√®mes sont con√ßus pour l'analyse et le reporting. Ils utilisent des structures d√©normalis√©es (sch√©ma en √©toile ou flocon) optimis√©es pour les requ√™tes complexes d'agr√©gation. L'objectif n'est plus de capturer des transactions mais de r√©pondre √† des questions analytiques comme "Quel est le chiffre d'affaires par r√©gion et par trimestre ?"</p>

        <h3>üîπ Le r√¥le de Pentaho Data Integration (PDI)</h3>
        
        <p>Pentaho PDI, √©galement appel√© Kettle, est un outil ETL (Extract, Transform, Load) open-source qui permet de :</p>
        <ul>
            <li><strong>Extraire</strong> : R√©cup√©rer les donn√©es depuis diverses sources (bases de donn√©es, fichiers CSV, API, etc.)</li>
            <li><strong>Transformer</strong> : Nettoyer, enrichir, agr√©ger et convertir les donn√©es selon les besoins m√©tier</li>
            <li><strong>Charger</strong> : Ins√©rer les donn√©es transform√©es dans le Data Warehouse</li>
        </ul>

        <p>Pentaho utilise une interface graphique intuitive permettant de cr√©er des transformations et des jobs sans n√©cessiter de code complexe.</p>

        <h3>üîπ Le r√¥le du Data Warehouse (DWH)</h3>
        
        <p>Le Data Warehouse est une base de donn√©es centralis√©e con√ßue sp√©cifiquement pour l'analyse. Il utilise un <strong>sch√©ma en √©toile</strong> compos√© de :</p>
        <ul>
            <li><strong>Tables de faits</strong> : Contiennent les m√©triques quantitatives (ventes, quantit√©s, montants)</li>
            <li><strong>Tables de dimensions</strong> : Contiennent les contextes descriptifs (clients, produits, temps, g√©ographie)</li>
        </ul>

        <p>Cette structure permet des requ√™tes rapides et une navigation intuitive dans les donn√©es pour l'analyse multidimensionnelle.</p>

        <h3>üîπ Le r√¥le de Power BI</h3>
        
        <p>Power BI est l'outil de visualisation et de reporting de Microsoft. Il permet de :</p>
        <ul>
            <li>Se connecter directement au Data Warehouse</li>
            <li>Cr√©er des tableaux de bord interactifs</li>
            <li>G√©n√©rer des rapports visuels dynamiques</li>
            <li>Partager les analyses avec les d√©cideurs</li>
        </ul>



        <h2>Sc√©nario M√©tier</h2>
        
        <p>Nous allons travailler sur un cas r√©el d'une entreprise e-commerce fictive nomm√©e <strong>"TechStore"</strong>.</p>

        <h3>Contexte</h3>
        <p>TechStore vend des produits √©lectroniques et informatiques en ligne. L'entreprise poss√®de une base de donn√©es op√©rationnelle (OLTP) qui enregistre toutes les transactions quotidiennes : inscriptions clients, cr√©ations de produits, passation de commandes, etc.</p>

        <h3>Probl√©matique</h3>
        <p>La direction de TechStore souhaite r√©pondre aux questions analytiques suivantes :</p>
        <ul>
            <li>Quel est le chiffre d'affaires par ville ?</li>
            <li>Quelles cat√©gories de produits g√©n√®rent le plus de revenus ?</li>
            <li>Comment √©voluent les ventes mois par mois ?</li>
            <li>Quels sont les 10 produits les plus vendus ?</li>
            <li>Quel est le montant moyen des commandes par client ?</li>
        </ul>

        <h3>Structure des donn√©es OLTP</h3>
        <p>La base de donn√©es op√©rationnelle contient quatre tables principales :</p>

        <table>
            <tr>
                <th>Table</th>
                <th>Description</th>
                <th>Contenu</th>
            </tr>
            <tr>
                <td><strong>clients</strong></td>
                <td>Informations sur les clients</td>
                <td>ID, nom, pr√©nom, email, ville, date d'inscription</td>
            </tr>
            <tr>
                <td><strong>produits</strong></td>
                <td>Catalogue des produits</td>
                <td>ID, nom, cat√©gorie, prix unitaire</td>
            </tr>
            <tr>
                <td><strong>commandes</strong></td>
                <td>En-t√™te des commandes</td>
                <td>ID, ID client, date commande, montant total</td>
            </tr>
            <tr>
                <td><strong>lignes_commandes</strong></td>
                <td>D√©tail des produits command√©s</td>
                <td>ID, ID commande, ID produit, quantit√©, prix unitaire</td>
            </tr>
        </table>

        <h3>Objectifs d'analyse</h3>
        <p>Nous allons construire un Data Warehouse permettant d'analyser :</p>
        <ul>
            <li>Les performances commerciales par dimension g√©ographique (ville)</li>
            <li>Les performances par cat√©gorie de produit</li>
            <li>L'√©volution temporelle des ventes (ann√©e, trimestre, mois, jour)</li>
            <li>Le comportement d'achat des clients</li>
        </ul>

        <h2>Architecture Globale du Projet</h2>

        <p>Voici une vue d'ensemble de l'architecture que nous allons mettre en place :</p>

        <div class="mermaid">
            graph LR
                A["üóÑÔ∏è Base OLTP MySQL<br/><b>ventes_oltp</b><br/>(Transactionnel)"] 
                B["üîÑ Pentaho PDI<br/><b>ETL</b><br/>(Extract-Transform-Load)"]
                C["üìä Data Warehouse MySQL<br/><b>ventes_dwh</b><br/>(Sch√©ma en √âtoile)"]
                D["üìà Power BI<br/><b>Reporting</b><br/>(Dashboards Interactifs)"]
                
                A -->|"Extraction des<br/>donn√©es brutes"| B
                B -->|"Chargement des<br/>donn√©es transform√©es"| C
                C -->|"Connexion et<br/>analyse"| D
                
                style A fill:#ff9999,stroke:#cc0000,stroke-width:3px
                style B fill:#99ccff,stroke:#0066cc,stroke-width:3px
                style C fill:#99ff99,stroke:#00cc00,stroke-width:3px
                style D fill:#ffcc99,stroke:#ff9900,stroke-width:3px
            </div>

        <h2>Mod√®le OLTP - Base Transactionnelle</h2>

        <h3>üîπ Description d√©taill√©e des tables</h3>

        <h4>Table : clients</h4>
        <p>Stocke les informations des clients inscrits sur la plateforme TechStore.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_client</td>
                <td>INT</td>
                <td>Cl√© primaire auto-incr√©ment√©e</td>
            </tr>
            <tr>
                <td>nom</td>
                <td>VARCHAR(100)</td>
                <td>Nom de famille du client</td>
            </tr>
            <tr>
                <td>prenom</td>
                <td>VARCHAR(100)</td>
                <td>Pr√©nom du client</td>
            </tr>
            <tr>
                <td>email</td>
                <td>VARCHAR(150)</td>
                <td>Adresse email unique</td>
            </tr>
            <tr>
                <td>ville</td>
                <td>VARCHAR(100)</td>
                <td>Ville de r√©sidence</td>
            </tr>
            <tr>
                <td>date_inscription</td>
                <td>DATE</td>
                <td>Date d'inscription du client</td>
            </tr>
        </table>

        <h4>Table : produits</h4>
        <p>Contient le catalogue complet des produits vendus.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_produit</td>
                <td>INT</td>
                <td>Cl√© primaire auto-incr√©ment√©e</td>
            </tr>
            <tr>
                <td>nom_produit</td>
                <td>VARCHAR(200)</td>
                <td>Nom commercial du produit</td>
            </tr>
            <tr>
                <td>categorie</td>
                <td>VARCHAR(100)</td>
                <td>Cat√©gorie (Ordinateurs, T√©l√©phones, etc.)</td>
            </tr>
            <tr>
                <td>prix_unitaire</td>
                <td>DECIMAL(10,2)</td>
                <td>Prix de vente unitaire</td>
            </tr>
        </table>

        <h4>Table : commandes</h4>
        <p>En-t√™te des commandes pass√©es par les clients.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_commande</td>
                <td>INT</td>
                <td>Cl√© primaire auto-incr√©ment√©e</td>
            </tr>
            <tr>
                <td>id_client</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers clients</td>
            </tr>
            <tr>
                <td>date_commande</td>
                <td>DATE</td>
                <td>Date de la commande</td>
            </tr>
            <tr>
                <td>montant_total</td>
                <td>DECIMAL(10,2)</td>
                <td>Montant total de la commande</td>
            </tr>
        </table>

        <h4>Table : lignes_commandes</h4>
        <p>D√©tail des produits contenus dans chaque commande.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_ligne</td>
                <td>INT</td>
                <td>Cl√© primaire auto-incr√©ment√©e</td>
            </tr>
            <tr>
                <td>id_commande</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers commandes</td>
            </tr>
            <tr>
                <td>id_produit</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers produits</td>
            </tr>
            <tr>
                <td>quantite</td>
                <td>INT</td>
                <td>Quantit√© command√©e</td>
            </tr>
            <tr>
                <td>prix_unitaire</td>
                <td>DECIMAL(10,2)</td>
                <td>Prix unitaire au moment de la commande</td>
            </tr>
        </table>

        <h3>üîπ Diagramme ERD (Entity Relationship Diagram)</h3>

        <div class="mermaid">
            graph TB
                subgraph "BASE DE DONN√âES OLTP - ventes_oltp"
                    C["<b>CLIENTS</b><br/>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br/>üîë id_client (PK)<br/>‚Ä¢ nom<br/>‚Ä¢ prenom<br/>‚Ä¢ email<br/>‚Ä¢ ville<br/>‚Ä¢ date_inscription"]
                    P["<b>PRODUITS</b><br/>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br/>üîë id_produit (PK)<br/>‚Ä¢ nom_produit<br/>‚Ä¢ categorie<br/>‚Ä¢ prix_unitaire"]
                    CMD["<b>COMMANDES</b><br/>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br/>üîë id_commande (PK)<br/>üîó id_client (FK)<br/>‚Ä¢ date_commande<br/>‚Ä¢ montant_total"]
                    LC["<b>LIGNES_COMMANDES</b><br/>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br/>üîë id_ligne (PK)<br/>üîó id_commande (FK)<br/>üîó id_produit (FK)<br/>‚Ä¢ quantite<br/>‚Ä¢ prix_unitaire"]
                end
                
                C -->|"1 client<br/>‚¨áÔ∏è<br/>0..N commandes"| CMD
                CMD -->|"1 commande<br/>‚¨áÔ∏è<br/>1..N lignes"| LC
                P -->|"1 produit<br/>‚¨áÔ∏è<br/>0..N lignes"| LC
                
                style C fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
                style P fill:#fff3e0,stroke:#f57c00,stroke-width:2px
                style CMD fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
                style LC fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
            </div>
            
            <div class="note">
                <strong>Les relations entre les tables:</strong>
                <ul>
                    <li><strong>CLIENTS (1) ‚îÄ‚îÄ‚Üí (0..N) COMMANDES</strong><br/>
                        ‚ûú Un client peut passer <strong>z√©ro ou plusieurs</strong> commandes<br/>
                        ‚ûú Une commande appartient √† <strong>un seul</strong> client
                    </li>
                    <li><strong>COMMANDES (1) ‚îÄ‚îÄ‚Üí (1..N) LIGNES_COMMANDES</strong><br/>
                        ‚ûú Une commande contient <strong>au moins une</strong> ligne de commande<br/>
                        ‚ûú Une ligne appartient √† <strong>une seule</strong> commande
                    </li>
                    <li><strong>PRODUITS (1) ‚îÄ‚îÄ‚Üí (0..N) LIGNES_COMMANDES</strong><br/>
                        ‚ûú Un produit peut √™tre dans <strong>z√©ro ou plusieurs</strong> lignes<br/>
                        ‚ûú Une ligne concerne <strong>un seul</strong> produit
                    </li>
                </ul>
            </div>

        <h2>Script SQL Complet - Base OLTP</h2>

        <p>Voici le script SQL complet pour cr√©er la base de donn√©es transactionnelle. Copiez et ex√©cutez ce script dans MySQL Workbench.</p>

        <pre><code>-- ========================================
-- CR√âATION DE LA BASE DE DONN√âES OLTP
-- ========================================

DROP DATABASE IF EXISTS ventes_oltp;
CREATE DATABASE ventes_oltp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE ventes_oltp;

-- ========================================
-- TABLE : clients
-- ========================================
CREATE TABLE clients (
    id_client INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    prenom VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    ville VARCHAR(100) NOT NULL,
    date_inscription DATE NOT NULL,
    INDEX idx_ville (ville),
    INDEX idx_date_inscription (date_inscription)
) ENGINE=InnoDB;

-- ========================================
-- TABLE : produits
-- ========================================
CREATE TABLE produits (
    id_produit INT AUTO_INCREMENT PRIMARY KEY,
    nom_produit VARCHAR(200) NOT NULL,
    categorie VARCHAR(100) NOT NULL,
    prix_unitaire DECIMAL(10,2) NOT NULL,
    INDEX idx_categorie (categorie)
) ENGINE=InnoDB;

-- ========================================
-- TABLE : commandes
-- ========================================
CREATE TABLE commandes (
    id_commande INT AUTO_INCREMENT PRIMARY KEY,
    id_client INT NOT NULL,
    date_commande DATE NOT NULL,
    montant_total DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (id_client) REFERENCES clients(id_client) ON DELETE CASCADE,
    INDEX idx_client (id_client),
    INDEX idx_date (date_commande)
) ENGINE=InnoDB;

-- ========================================
-- TABLE : lignes_commandes
-- ========================================
CREATE TABLE lignes_commandes (
    id_ligne INT AUTO_INCREMENT PRIMARY KEY,
    id_commande INT NOT NULL,
    id_produit INT NOT NULL,
    quantite INT NOT NULL,
    prix_unitaire DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (id_commande) REFERENCES commandes(id_commande) ON DELETE CASCADE,
    FOREIGN KEY (id_produit) REFERENCES produits(id_produit) ON DELETE CASCADE,
    INDEX idx_commande (id_commande),
    INDEX idx_produit (id_produit)
) ENGINE=InnoDB;

-- ========================================
-- V√âRIFICATION DE LA STRUCTURE
-- ========================================
SHOW TABLES;
DESCRIBE clients;
DESCRIBE produits;
DESCRIBE commandes;
DESCRIBE lignes_commandes;</code></pre>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Vous devriez voir 4 tables cr√©√©es dans la base ventes_oltp. Les relations entre tables sont √©tablies via les cl√©s √©trang√®res.
        </div>

        <h2>üî¢ G√©n√©ration d'un Dataset de 100 000 lignes</h2>

        <p>Pour que notre TP soit r√©aliste, nous allons g√©n√©rer un jeu de donn√©es cons√©quent. Nous utiliserons Python avec la biblioth√®que Faker pour cr√©er des donn√©es synth√©tiques.</p>

        <div class="warning">
            <strong>Important :</strong> Nous n'afficherons pas les 100 000 lignes ! Nous allons g√©n√©rer les fichiers CSV, puis vous montrerons seulement quelques exemples pour comprendre la structure.
        </div>

        <h3>üîπ Script Python complet</h3>

        <p>Installez d'abord les d√©pendances n√©cessaires :</p>

        <pre><code>pip install faker pandas</code></pre>

        <p>Ensuite, cr√©ez un fichier <code>generate_data.py</code> avec le contenu suivant :</p>

        <pre><code>import pandas as pd
from faker import Faker
import random
from datetime import datetime, timedelta

# Initialisation
fake = Faker('fr_FR')
random.seed(42)
Faker.seed(42)

print("G√©n√©ration des donn√©es en cours...")

# ========================================
# G√âN√âRATION DES CLIENTS (10 000)
# ========================================
print("G√©n√©ration de 10 000 clients...")

villes = ['Paris', 'Lyon', 'Marseille', 'Toulouse', 'Nice', 'Nantes', 
          'Strasbourg', 'Montpellier', 'Bordeaux', 'Lille', 'Rennes', 'Reims']

clients_data = []
for i in range(1, 10001):
    clients_data.append({
        'id_client': i,
        'nom': fake.last_name(),
        'prenom': fake.first_name(),
        'email': f"client{i}@{fake.free_email_domain()}",
        'ville': random.choice(villes),
        'date_inscription': fake.date_between(start_date='-3y', end_date='today')
    })

df_clients = pd.DataFrame(clients_data)
df_clients.to_csv('clients.csv', index=False, encoding='utf-8')
print(f"Fichier clients.csv cr√©√© : {len(df_clients)} lignes")

# ========================================
# G√âN√âRATION DES PRODUITS (500)
# ========================================
print("G√©n√©ration de 500 produits...")

categories = {
    'Ordinateurs': ['MacBook Pro', 'Dell XPS', 'HP Pavilion', 'Lenovo ThinkPad', 'Asus VivoBook'],
    'T√©l√©phones': ['iPhone 14', 'Samsung Galaxy S23', 'Google Pixel 7', 'OnePlus 11', 'Xiaomi 13'],
    'Tablettes': ['iPad Pro', 'Samsung Galaxy Tab', 'Microsoft Surface', 'Lenovo Tab', 'Huawei MatePad'],
    'Accessoires': ['Souris Logitech', 'Clavier m√©canique', 'Casque Bose', 'Webcam HD', 'Hub USB-C'],
    'Montres': ['Apple Watch', 'Samsung Galaxy Watch', 'Garmin Forerunner', 'Fitbit Sense', 'Huawei Watch']
}

produits_data = []
id_produit = 1
for categorie, noms_base in categories.items():
    for _ in range(100):  # 100 produits par cat√©gorie
        nom_base = random.choice(noms_base)
        produits_data.append({
            'id_produit': id_produit,
            'nom_produit': f"{nom_base} {random.choice(['Pro', 'Plus', 'Ultra', 'Standard', 'Lite'])}",
            'categorie': categorie,
            'prix_unitaire': round(random.uniform(50, 2000), 2)
        })
        id_produit += 1

df_produits = pd.DataFrame(produits_data)
df_produits.to_csv('produits.csv', index=False, encoding='utf-8')
print(f"Fichier produits.csv cr√©√© : {len(df_produits)} lignes")

# ========================================
# G√âN√âRATION DES COMMANDES (20 000)
# ========================================
print("G√©n√©ration de 20 000 commandes...")

commandes_data = []
start_date = datetime(2022, 1, 1)
end_date = datetime(2024, 12, 31)

for i in range(1, 20001):
    random_days = random.randint(0, (end_date - start_date).days)
    date_commande = start_date + timedelta(days=random_days)
    
    commandes_data.append({
        'id_commande': i,
        'id_client': random.randint(1, 10000),
        'date_commande': date_commande.strftime('%Y-%m-%d'),
        'montant_total': 0  # Sera calcul√© plus tard
    })

df_commandes = pd.DataFrame(commandes_data)

# ========================================
# G√âN√âRATION DES LIGNES DE COMMANDES (100 000)
# ========================================
print("G√©n√©ration de 100 000 lignes de commandes...")

lignes_data = []
montants_par_commande = {}

for i in range(1, 100001):
    id_commande = random.randint(1, 20000)
    id_produit = random.randint(1, 500)
    quantite = random.randint(1, 5)
    prix_unitaire = df_produits.loc[df_produits['id_produit'] == id_produit, 'prix_unitaire'].values[0]
    
    lignes_data.append({
        'id_ligne': i,
        'id_commande': id_commande,
        'id_produit': id_produit,
        'quantite': quantite,
        'prix_unitaire': prix_unitaire
    })
    
    # Calcul du montant total de la commande
    montant_ligne = quantite * prix_unitaire
    if id_commande in montants_par_commande:
        montants_par_commande[id_commande] += montant_ligne
    else:
        montants_par_commande[id_commande] = montant_ligne

df_lignes = pd.DataFrame(lignes_data)
df_lignes.to_csv('lignes_commandes.csv', index=False, encoding='utf-8')
print(f"Fichier lignes_commandes.csv cr√©√© : {len(df_lignes)} lignes")

# Mise √† jour des montants totaux dans commandes
df_commandes['montant_total'] = df_commandes['id_commande'].map(
    lambda x: round(montants_par_commande.get(x, 0), 2)
)
df_commandes.to_csv('commandes.csv', index=False, encoding='utf-8')
print(f"Fichier commandes.csv cr√©√© : {len(df_commandes)} lignes")

print("\nG√©n√©ration termin√©e avec succ√®s !")
print("Fichiers cr√©√©s : clients.csv, produits.csv, commandes.csv, lignes_commandes.csv")</code></pre>

        <h3>üîπ Ex√©cution du script</h3>

        <div class="step">
            <p class="step-number">√âtape 1 :</p>
            <p>Ouvrez votre terminal ou invite de commande</p>
        </div>

        <div class="step">
            <p class="step-number">√âtape 2 :</p>
            <p>Naviguez vers le dossier contenant le fichier <code>generate_data.py</code></p>
            <pre><code>cd chemin/vers/votre/dossier</code></pre>
        </div>

        <div class="step">
            <p class="step-number">√âtape 3 :</p>
            <p>Ex√©cutez le script Python</p>
            <pre><code>python generate_data.py</code></pre>
        </div>

        <div class="step">
            <p class="step-number">√âtape 4 :</p>
            <p>Attendez quelques secondes. Vous verrez les messages de progression s'afficher</p>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Quatre fichiers CSV sont cr√©√©s dans votre dossier : clients.csv, produits.csv, commandes.csv, et lignes_commandes.csv
        </div>

        <h3>üîπ Aper√ßu des donn√©es g√©n√©r√©es</h3>

        <p>Voici quelques exemples de lignes pour comprendre la structure des donn√©es :</p>

        <h4>Extrait de clients.csv (5 premi√®res lignes)</h4>
        <pre><code>id_client,nom,prenom,email,ville,date_inscription
1,Dupont,Marie,client1@gmail.com,Paris,2023-05-12
2,Martin,Pierre,client2@yahoo.fr,Lyon,2022-08-23
3,Bernard,Sophie,client3@outlook.com,Marseille,2024-01-15
4,Dubois,Luc,client4@gmail.com,Toulouse,2023-11-08
5,Thomas,Julie,client5@orange.fr,Nice,2022-03-19</code></pre>

        <h4>Extrait de produits.csv (5 premi√®res lignes)</h4>
        <pre><code>id_produit,nom_produit,categorie,prix_unitaire
1,MacBook Pro Ultra,Ordinateurs,1899.99
2,Dell XPS Plus,Ordinateurs,1299.50
3,HP Pavilion Standard,Ordinateurs,799.99
4,Lenovo ThinkPad Pro,Ordinateurs,1450.00
5,Asus VivoBook Lite,Ordinateurs,649.99</code></pre>

        <h4>Extrait de commandes.csv (5 premi√®res lignes)</h4>
        <pre><code>id_commande,id_client,date_commande,montant_total
1,3542,2023-07-15,2349.98
2,8901,2024-02-28,899.99
3,1234,2022-11-12,3599.97
4,5678,2023-09-05,1249.50
5,9012,2024-06-18,4599.95</code></pre>

        <h4>Extrait de lignes_commandes.csv (5 premi√®res lignes)</h4>
        <pre><code>id_ligne,id_commande,id_produit,quantite,prix_unitaire
1,1,45,2,899.99
2,1,128,1,549.00
3,2,203,1,899.99
4,3,12,3,1199.99
5,4,76,1,1249.50</code></pre>

        <div class="note">
            <strong>Remarques importantes :</strong>
            <ul>
                <li>Les donn√©es sont g√©n√©r√©es de mani√®re <strong>coh√©rente</strong> : les id_client et id_produit r√©f√©rencent bien les tables correspondantes</li>
                <li>Les dates sont r√©parties sur une p√©riode de <strong>3 ans</strong> (2022-2024)</li>
                <li>Les prix sont <strong>r√©alistes</strong> pour un commerce √©lectronique</li>
                <li>Le montant_total des commandes correspond √† la somme des lignes_commandes</li>
            </ul>
        </div>

        <h2>Importation des CSV dans MySQL</h2>

        <p>Maintenant que nous avons g√©n√©r√© nos fichiers CSV, nous allons les importer dans la base de donn√©es MySQL. Voici un tutoriel d√©taill√© pour d√©butants.</p>

        <div class="warning">
            <strong>Pr√©requis :</strong> MySQL et MySQL Workbench doivent √™tre install√©s sur votre machine. La base ventes_oltp doit avoir √©t√© cr√©√©e avec le script SQL pr√©c√©dent.
        </div>

        <h3>üîπ M√©thode 1 : Importation via MySQL Workbench (Recommand√©e)</h3>

        <div class="step">
            <p class="step-number">√âtape 1 : Ouvrir MySQL Workbench</p>
            <p>Lancez MySQL Workbench et connectez-vous √† votre serveur MySQL local</p>
        </div>

        <div class="step">
            <p class="step-number">√âtape 2 : S√©lectionner la base de donn√©es</p>
            <p>Dans le panneau de gauche (Navigator), cliquez sur <strong>Schemas</strong>, puis double-cliquez sur <strong>ventes_oltp</strong> pour la s√©lectionner</p>
        </div>

        <div class="step">
            <p class="step-number">√âtape 3 : Importer clients.csv</p>
            <ol>
                <li>Clic droit sur la table <strong>clients</strong> ‚Üí <strong>Table Data Import Wizard</strong></li>
                <li>Cliquez sur <strong>Browse</strong> et s√©lectionnez le fichier <strong>clients.csv</strong></li>
                <li>Cliquez sur <strong>Next</strong></li>
                <li>S√©lectionnez <strong>Use existing table : ventes_oltp.clients</strong></li>
                <li>Cliquez sur <strong>Next</strong></li>
                <li>V√©rifiez que les colonnes correspondent correctement (MySQL Workbench fait g√©n√©ralement la correspondance automatiquement)</li>
                <li>Cliquez sur <strong>Next</strong> puis <strong>Next</strong> √† nouveau</li>
                <li>Attendez la fin de l'importation (quelques secondes pour 10 000 lignes)</li>
                <li>Cliquez sur <strong>Finish</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 4 : Importer produits.csv</p>
            <p>R√©p√©tez exactement les m√™mes √©tapes que pour clients.csv, mais en s√©lectionnant la table <strong>produits</strong> et le fichier <strong>produits.csv</strong></p>
        </div>

        <div class="step">
            <p class="step-number">√âtape 5 : Importer commandes.csv</p>
            <p>R√©p√©tez les √©tapes pour la table <strong>commandes</strong> et le fichier <strong>commandes.csv</strong></p>
        </div>

        <div class="step">
            <p class="step-number">√âtape 6 : Importer lignes_commandes.csv</p>
            <p>R√©p√©tez les √©tapes pour la table <strong>lignes_commandes</strong> et le fichier <strong>lignes_commandes.csv</strong></p>
            <p><strong>Note :</strong> Cette importation peut prendre 1-2 minutes car il y a 100 000 lignes</p>
        </div>

        <h3>üîπ M√©thode 2 : Importation via SQL LOAD DATA (Alternative)</h3>

        <p>Si vous pr√©f√©rez utiliser des commandes SQL, voici le script :</p>

        <pre><code>USE ventes_oltp;

-- D√©sactiver temporairement les contraintes
SET FOREIGN_KEY_CHECKS = 0;

-- Importer clients
LOAD DATA LOCAL INFILE 'C:/chemin/vers/clients.csv'
INTO TABLE clients
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS
(id_client, nom, prenom, email, ville, date_inscription);

-- Importer produits
LOAD DATA LOCAL INFILE 'C:/chemin/vers/produits.csv'
INTO TABLE produits
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS
(id_produit, nom_produit, categorie, prix_unitaire);

-- Importer commandes
LOAD DATA LOCAL INFILE 'C:/chemin/vers/commandes.csv'
INTO TABLE commandes
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS
(id_commande, id_client, date_commande, montant_total);

-- Importer lignes_commandes
LOAD DATA LOCAL INFILE 'C:/chemin/vers/lignes_commandes.csv'
INTO TABLE lignes_commandes
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS
(id_ligne, id_commande, id_produit, quantite, prix_unitaire);

-- R√©activer les contraintes
SET FOREIGN_KEY_CHECKS = 1;</code></pre>

        <div class="warning">
            <strong>Attention :</strong> Remplacez <code>C:/chemin/vers/</code> par le chemin r√©el o√π se trouvent vos fichiers CSV. Utilisez des slashes (/) m√™me sous Windows dans les chemins MySQL.
        </div>

        <h3>üîπ V√©rification de l'importation</h3>

        <p>Apr√®s l'importation, v√©rifiez que tout s'est bien pass√© avec ces requ√™tes :</p>

        <pre><code>USE ventes_oltp;

-- Compter les lignes de chaque table
SELECT 'clients' AS table_name, COUNT(*) AS nb_lignes FROM clients
UNION ALL
SELECT 'produits', COUNT(*) FROM produits
UNION ALL
SELECT 'commandes', COUNT(*) FROM commandes
UNION ALL
SELECT 'lignes_commandes', COUNT(*) FROM lignes_commandes;

-- Afficher quelques exemples
SELECT * FROM clients LIMIT 5;
SELECT * FROM produits LIMIT 5;
SELECT * FROM commandes LIMIT 5;
SELECT * FROM lignes_commandes LIMIT 5;</code></pre>

        <div class="success">
            <strong>R√©sultat attendu :</strong>
            <ul>
                <li>clients : 10 000 lignes</li>
                <li>produits : 500 lignes</li>
                <li>commandes : 20 000 lignes</li>
                <li>lignes_commandes : 100 000 lignes</li>
            </ul>
        </div>

        <h2>Data Warehouse - Sch√©ma en √âtoile</h2>

        <p>Nous allons maintenant concevoir notre Data Warehouse avec un <strong>sch√©ma en √©toile</strong> (Star Schema). Cette structure est optimis√©e pour les requ√™tes analytiques et les outils de BI.</p>

        <h3>üîπ Pourquoi un sch√©ma en √©toile ?</h3>

        <table>
            <tr>
                <th>Avantage</th>
                <th>Explication</th>
            </tr>
            <tr>
                <td>Simplicit√©</td>
                <td>Structure intuitive avec une table de faits centrale et des dimensions autour</td>
            </tr>
            <tr>
                <td>Performance</td>
                <td>Moins de jointures n√©cessaires, requ√™tes plus rapides</td>
            </tr>
            <tr>
                <td>Compr√©hension</td>
                <td>Les utilisateurs m√©tier comprennent facilement le mod√®le</td>
            </tr>
            <tr>
                <td>Compatibilit√©</td>
                <td>Optimal pour les outils de BI comme Power BI, Tableau, QlikView</td>
            </tr>
        </table>

        <h3>üîπ Description des tables du Data Warehouse</h3>

        <h4>Table de faits : FactVentes</h4>
        <p>La table centrale contenant les m√©triques quantitatives.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_vente</td>
                <td>INT</td>
                <td>Cl√© primaire (surrogate key)</td>
            </tr>
            <tr>
                <td>id_client_dim</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers DimClient</td>
            </tr>
            <tr>
                <td>id_produit_dim</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers DimProduit</td>
            </tr>
            <tr>
                <td>id_date_dim</td>
                <td>INT</td>
                <td>Cl√© √©trang√®re vers DimDate</td>
            </tr>
            <tr>
                <td>quantite</td>
                <td>INT</td>
                <td>Quantit√© vendue</td>
            </tr>
            <tr>
                <td>prix_unitaire</td>
                <td>DECIMAL(10,2)</td>
                <td>Prix unitaire</td>
            </tr>
            <tr>
                <td>montant_total</td>
                <td>DECIMAL(10,2)</td>
                <td>Montant total (quantit√© √ó prix)</td>
            </tr>
        </table>

        <h4>Dimension : DimClient</h4>
        <p>Contient les informations descriptives sur les clients.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_client_dim</td>
                <td>INT</td>
                <td>Cl√© surrogate (auto-incr√©ment√©e)</td>
            </tr>
            <tr>
                <td>id_client_source</td>
                <td>INT</td>
                <td>Cl√© naturelle (ID depuis OLTP)</td>
            </tr>
            <tr>
                <td>nom_complet</td>
                <td>VARCHAR(200)</td>
                <td>Nom et pr√©nom concat√©n√©s</td>
            </tr>
            <tr>
                <td>email</td>
                <td>VARCHAR(150)</td>
                <td>Email du client</td>
            </tr>
            <tr>
                <td>ville</td>
                <td>VARCHAR(100)</td>
                <td>Ville de r√©sidence</td>
            </tr>
        </table>

        <h4>Dimension : DimProduit</h4>
        <p>Contient les informations descriptives sur les produits.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_produit_dim</td>
                <td>INT</td>
                <td>Cl√© surrogate (auto-incr√©ment√©e)</td>
            </tr>
            <tr>
                <td>id_produit_source</td>
                <td>INT</td>
                <td>Cl√© naturelle (ID depuis OLTP)</td>
            </tr>
            <tr>
                <td>nom_produit</td>
                <td>VARCHAR(200)</td>
                <td>Nom du produit</td>
            </tr>
            <tr>
                <td>categorie</td>
                <td>VARCHAR(100)</td>
                <td>Cat√©gorie du produit</td>
            </tr>
        </table>

        <h4>Dimension : DimDate</h4>
        <p>Table de dates pr√©calcul√©es permettant une analyse temporelle riche.</p>
        <table>
            <tr>
                <th>Colonne</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>id_date_dim</td>
                <td>INT</td>
                <td>Cl√© surrogate (format YYYYMMDD)</td>
            </tr>
            <tr>
                <td>date_complete</td>
                <td>DATE</td>
                <td>Date compl√®te</td>
            </tr>
            <tr>
                <td>annee</td>
                <td>INT</td>
                <td>Ann√©e (ex: 2024)</td>
            </tr>
            <tr>
                <td>trimestre</td>
                <td>INT</td>
                <td>Trimestre (1-4)</td>
            </tr>
            <tr>
                <td>mois</td>
                <td>INT</td>
                <td>Mois (1-12)</td>
            </tr>
            <tr>
                <td>nom_mois</td>
                <td>VARCHAR(20)</td>
                <td>Nom du mois (Janvier, F√©vrier...)</td>
            </tr>
            <tr>
                <td>jour</td>
                <td>INT</td>
                <td>Jour du mois (1-31)</td>
            </tr>
            <tr>
                <td>jour_semaine</td>
                <td>INT</td>
                <td>Jour de la semaine (1=Lundi, 7=Dimanche)</td>
            </tr>
            <tr>
                <td>nom_jour</td>
                <td>VARCHAR(20)</td>
                <td>Nom du jour (Lundi, Mardi...)</td>
            </tr>
        </table>

        <h3>üîπ Sch√©ma en √âtoile - Diagramme Mermaid</h3>

        <div class="mermaid">
            graph TB
                subgraph "DATA WAREHOUSE - Sch√©ma en √âtoile"
                    FACT["<b>FACT VENTES</b><br/>(Table de Faits)<br/>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê<br/>üîë id_vente (PK)<br/>üîó id_client_dim (FK)<br/>üîó id_produit_dim (FK)<br/>üîó id_date_dim (FK)<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>üìà quantite<br/>üìà prix_unitaire<br/>üìà montant_total"]
                    
                    DC["<b>DIM CLIENT</b><br/>(Dimension)<br/>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê<br/>üîë id_client_dim (PK)<br/>‚Ä¢ id_client_source<br/>‚Ä¢ nom_complet<br/>‚Ä¢ email<br/>‚Ä¢ ville"]
                    
                    DP["<b>DIM PRODUIT</b><br/>(Dimension)<br/>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê<br/>üîë id_produit_dim (PK)<br/>‚Ä¢ id_produit_source<br/>‚Ä¢ nom_produit<br/>‚Ä¢ categorie"]
                    
                    DD["<b>DIM DATE</b><br/>(Dimension)<br/>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê<br/>üîë id_date_dim (PK)<br/>‚Ä¢ date_complete<br/>‚Ä¢ annee<br/>‚Ä¢ trimestre<br/>‚Ä¢ mois<br/>‚Ä¢ nom_mois<br/>‚Ä¢ jour<br/>‚Ä¢ jour_semaine<br/>‚Ä¢ nom_jour"]
                end
                
                DC -->|"<b>1 client</b><br/>‚¨áÔ∏è<br/><b>N ventes</b>"| FACT
                DP -->|"<b>1 produit</b><br/>‚¨áÔ∏è<br/><b>N ventes</b>"| FACT
                DD -->|"<b>1 date</b><br/>‚¨áÔ∏è<br/><b>N ventes</b>"| FACT
                
                style FACT fill:#fff9c4,stroke:#f57f17,stroke-width:4px
                style DC fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
                style DP fill:#fff3e0,stroke:#f57c00,stroke-width:3px
                style DD fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px
            </div>
            
            <div class="note">
                <strong>D√©tail du sch√©ma en √©toile :</strong>
                <ul>
                    <li><strong>DimClient (1) ‚îÄ‚îÄ‚Üí (N) FactVentes</strong><br/>
                        ‚ûú Un client peut avoir <strong>plusieurs ventes</strong> dans la table de faits<br/>
                        ‚ûú Chaque vente est associ√©e √† <strong>un seul client</strong><br/>
                        ‚ûú <em>Relation : 1:N (un √† plusieurs)</em>
                    </li>
                    <li><strong>DimProduit (1) ‚îÄ‚îÄ‚Üí (N) FactVentes</strong><br/>
                        ‚ûú Un produit peut appara√Ætre dans <strong>plusieurs ventes</strong><br/>
                        ‚ûú Chaque vente concerne <strong>un seul produit</strong><br/>
                        ‚ûú <em>Relation : 1:N (un √† plusieurs)</em>
                    </li>
                    <li><strong>DimDate (1) ‚îÄ‚îÄ‚Üí (N) FactVentes</strong><br/>
                        ‚ûú Une date peut avoir <strong>plusieurs ventes</strong><br/>
                        ‚ûú Chaque vente est enregistr√©e √† <strong>une seule date</strong><br/>
                        ‚ûú <em>Relation : 1:N (un √† plusieurs)</em>
                    </li>
                </ul>
                <p><strong>Principe du sch√©ma en √©toile :</strong> Toutes les dimensions (DimClient, DimProduit, DimDate) sont reli√©es directement √† la table de faits centrale (FactVentes) avec des relations <strong>1:N</strong>. C'est cette structure qui donne la forme d'une "√©toile"  et optimise les performances des requ√™tes analytiques.</p>
            </div>

        <div class="note">
            <strong>Remarques sur le sch√©ma en √©toile :</strong>
            <ul>
                <li><strong>Cl√©s surrogates</strong> : Nous utilisons des cl√©s artificielles (id_xxx_dim) pour garantir l'unicit√© et faciliter les mises √† jour</li>
                <li><strong>D√©normalisation</strong> : Les dimensions contiennent des donn√©es redondantes (ex: nom_mois) pour acc√©l√©rer les requ√™tes</li>
                <li><strong>DimDate</strong> : Cette dimension est g√©n√©r√©e artificiellement et n'existe pas dans l'OLTP</li>
                <li><strong>FactVentes</strong> : Contient uniquement des cl√©s √©trang√®res et des m√©triques num√©riques</li>
            </ul>
        </div>

        <h2>Script SQL Complet du Data Warehouse</h2>

        <p>Voici le script SQL pour cr√©er la structure du Data Warehouse. Ce script pr√©pare les tables vides qui seront aliment√©es par Pentaho.</p>

        <pre><code>-- ========================================
-- CR√âATION DE LA BASE DE DONN√âES DWH
-- ========================================

DROP DATABASE IF EXISTS ventes_dwh;
CREATE DATABASE ventes_dwh CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE ventes_dwh;

-- ========================================
-- DIMENSION : DimClient
-- ========================================
CREATE TABLE DimClient (
    id_client_dim INT AUTO_INCREMENT PRIMARY KEY,
    id_client_source INT NOT NULL,
    nom_complet VARCHAR(200) NOT NULL,
    email VARCHAR(150) NOT NULL,
    ville VARCHAR(100) NOT NULL,
    UNIQUE KEY uk_client_source (id_client_source),
    INDEX idx_ville (ville)
) ENGINE=InnoDB;

-- ========================================
-- DIMENSION : DimProduit
-- ========================================
CREATE TABLE DimProduit (
    id_produit_dim INT AUTO_INCREMENT PRIMARY KEY,
    id_produit_source INT NOT NULL,
    nom_produit VARCHAR(200) NOT NULL,
    categorie VARCHAR(100) NOT NULL,
    UNIQUE KEY uk_produit_source (id_produit_source),
    INDEX idx_categorie (categorie)
) ENGINE=InnoDB;

-- ========================================
-- DIMENSION : DimDate
-- ========================================
CREATE TABLE DimDate (
    id_date_dim INT PRIMARY KEY,
    date_complete DATE NOT NULL UNIQUE,
    annee INT NOT NULL,
    trimestre INT NOT NULL,
    mois INT NOT NULL,
    nom_mois VARCHAR(20) NOT NULL,
    jour INT NOT NULL,
    jour_semaine INT NOT NULL,
    nom_jour VARCHAR(20) NOT NULL,
    INDEX idx_annee (annee),
    INDEX idx_mois (mois),
    INDEX idx_trimestre (trimestre)
) ENGINE=InnoDB;

-- ========================================
-- TABLE DE FAITS : FactVentes
-- ========================================
CREATE TABLE FactVentes (
    id_vente INT AUTO_INCREMENT PRIMARY KEY,
    id_client_dim INT NOT NULL,
    id_produit_dim INT NOT NULL,
    id_date_dim INT NOT NULL,
    quantite INT NOT NULL,
    prix_unitaire DECIMAL(10,2) NOT NULL,
    montant_total DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (id_client_dim) REFERENCES DimClient(id_client_dim),
    FOREIGN KEY (id_produit_dim) REFERENCES DimProduit(id_produit_dim),
    FOREIGN KEY (id_date_dim) REFERENCES DimDate(id_date_dim),
    INDEX idx_client (id_client_dim),
    INDEX idx_produit (id_produit_dim),
    INDEX idx_date (id_date_dim)
) ENGINE=InnoDB;

-- ========================================
-- V√âRIFICATION DE LA STRUCTURE
-- ========================================
SHOW TABLES;
DESCRIBE DimClient;
DESCRIBE DimProduit;
DESCRIBE DimDate;
DESCRIBE FactVentes;</code></pre>

        <div class="success">
            <strong>R√©sultat attendu :</strong> La base ventes_dwh est cr√©√©e avec 4 tables vides, pr√™tes √† recevoir les donn√©es transform√©es via Pentaho.
        </div>

        <h2>Pentaho PDI - Configuration et Transformations</h2>

        <p>Nous entrons maintenant dans la partie centrale du TP : l'utilisation de Pentaho Data Integration pour extraire, transformer et charger les donn√©es depuis OLTP vers le DWH.</p>

        <div class="warning">
            <strong>Pr√©requis :</strong> T√©l√©chargez et installez Pentaho Data Integration (PDI) depuis le site officiel de Hitachi Vantara. D√©compressez l'archive et lancez <code>Spoon.bat</code> (Windows) ou <code>spoon.sh</code> (Linux/Mac).
        </div>

        <h3>üîπ √âtape 1 : Configuration des connexions √† la base de donn√©es</h3>

        <p>Avant de cr√©er des transformations, nous devons configurer les connexions vers nos deux bases de donn√©es MySQL.</p>

        <div class="step">
            <p class="step-number">1.1 - Ouvrir Pentaho Spoon</p>
            <p>Lancez l'application Pentaho Data Integration (Spoon)</p>
        </div>

        <div class="step">
            <p class="step-number">1.2 - Cr√©er la connexion OLTP</p>
            <ol>
                <li>Dans le panneau de gauche, cliquez sur <strong>View</strong></li>
                <li>Clic droit sur <strong>Database connections</strong> ‚Üí <strong>New</strong></li>
                <li>Remplissez les champs suivants :
                    <ul>
                        <li><strong>Connection Name :</strong> OLTP_MySQL</li>
                        <li><strong>Connection Type :</strong> MySQL</li>
                        <li><strong>Access :</strong> Native (JDBC)</li>
                        <li><strong>Host Name :</strong> localhost</li>
                        <li><strong>Database Name :</strong> ventes_oltp</li>
                        <li><strong>Port Number :</strong> 3306</li>
                        <li><strong>User Name :</strong> root (ou votre utilisateur MySQL)</li>
                        <li><strong>Password :</strong> votre mot de passe MySQL</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>Test</strong> pour v√©rifier la connexion</li>
                <li>Si le test r√©ussit, cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">1.3 - Cr√©er la connexion DWH</p>
            <p>R√©p√©tez exactement les m√™mes √©tapes, mais avec :</p>
            <ul>
                <li><strong>Connection Name :</strong> DWH_MySQL</li>
                <li><strong>Database Name :</strong> ventes_dwh</li>
            </ul>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Vous voyez maintenant deux connexions dans le panneau "Database connections" : OLTP_MySQL et DWH_MySQL
        </div>

        <h3>üîπ √âtape 2 : Transformation 1 - Charger DimClient</h3>

        <p>Nous allons cr√©er notre premi√®re transformation pour extraire les clients de l'OLTP et les charger dans DimClient.</p>

        <div class="step">
            <p class="step-number">2.1 - Cr√©er une nouvelle transformation</p>
            <ol>
                <li>Cliquez sur <strong>File</strong> ‚Üí <strong>New</strong> ‚Üí <strong>Transformation</strong></li>
                <li>Sauvegardez imm√©diatement : <strong>File</strong> ‚Üí <strong>Save As</strong> ‚Üí Nommez-la <code>dim_client.ktr</code></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">2.2 - Ajouter un step "Table Input" (Extraction)</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>Design</strong>, d√©pliez <strong>Input</strong></li>
                <li>Double-cliquez sur <strong>Table input</strong> pour l'ajouter au canvas</li>
                <li>Double-cliquez sur l'ic√¥ne "Table input" dans le canvas</li>
                <li>Remplissez :
                    <ul>
                        <li><strong>Step name :</strong> Lecture_Clients_OLTP</li>
                        <li><strong>Connection :</strong> OLTP_MySQL</li>
                        <li><strong>SQL :</strong></li>
                    </ul>
                    <pre><code>SELECT 
    id_client,
    CONCAT(prenom, ' ', nom) AS nom_complet,
    email,
    ville
FROM clients</code></pre>
                </li>
                <li>Cliquez sur <strong>Preview</strong> pour v√©rifier que les donn√©es sont bien r√©cup√©r√©es (vous devriez voir 10 000 lignes)</li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">2.3 - Ajouter un step "Select values" (Transformation)</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>Transform</strong>, trouvez <strong>Select values</strong></li>
                <li>Glissez-d√©posez <strong>Select values</strong> sur le canvas</li>
                <li>Cr√©ez un lien (hop) : maintenez Shift, cliquez sur "Lecture_Clients_OLTP", puis cliquez sur "Select values"</li>
                <li>Double-cliquez sur "Select values"</li>
                <li>Remplissez :
                    <ul>
                        <li><strong>Step name :</strong> Renommer_Colonnes</li>
                        <li>Dans l'onglet <strong>Select & Alter</strong>, cliquez sur <strong>Get fields to select</strong></li>
                        <li>Renommez les champs :
                            <ul>
                                <li>id_client ‚Üí id_client_source</li>
                                <li>nom_complet ‚Üí nom_complet (garder tel quel)</li>
                                <li>email ‚Üí email (garder tel quel)</li>
                                <li>ville ‚Üí ville (garder tel quel)</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">2.4 - Ajouter un step "Table Output" (Chargement)</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>Output</strong>, trouvez <strong>Table output</strong></li>
                <li>Glissez-d√©posez <strong>Table output</strong> sur le canvas</li>
                <li>Cr√©ez un lien depuis "Renommer_Colonnes" vers "Table output"</li>
                <li>Double-cliquez sur "Table output"</li>
                <li>Remplissez :
                    <ul>
                        <li><strong>Step name :</strong> Ecriture_DimClient</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Target schema :</strong> (laisser vide)</li>
                        <li><strong>Target table :</strong> DimClient</li>
                        <li>Cochez <strong>Truncate table</strong> (pour vider la table avant insertion)</li>
                        <li>D√©cochez <strong>Specify database fields</strong> (Pentaho fera la correspondance automatiquement)</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="note">
            <strong>Votre transformation doit ressembler √† ceci :</strong><br>
            [Lecture_Clients_OLTP] ‚Üí [Renommer_Colonnes] ‚Üí [Ecriture_DimClient]
        </div>

        <div class="step">
            <p class="step-number">2.5 - Ex√©cuter la transformation</p>
            <ol>
                <li>Cliquez sur le bouton <strong>Run</strong> (ic√¥ne "Play" verte) dans la barre d'outils</li>
                <li>Dans la fen√™tre qui s'ouvre, cliquez sur <strong>Launch</strong></li>
                <li>Observez l'ex√©cution dans le panneau du bas</li>
                <li>Vous devriez voir : "Lecture_Clients_OLTP : 10000 rows", "Ecriture_DimClient : 10000 rows"</li>
            </ol>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> La table DimClient contient maintenant 10 000 lignes. V√©rifiez dans MySQL Workbench avec : <code>SELECT COUNT(*) FROM ventes_dwh.DimClient;</code>
        </div>

        <h3>üîπ √âtape 3 : Transformation 2 - Charger DimProduit</h3>

        <p>Nous allons cr√©er une transformation similaire pour les produits.</p>

        <div class="step">
            <p class="step-number">3.1 - Cr√©er une nouvelle transformation</p>
            <ol>
                <li>Cliquez sur <strong>File</strong> ‚Üí <strong>New</strong> ‚Üí <strong>Transformation</strong></li>
                <li>Sauvegardez : <code>dim_produit.ktr</code></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">3.2 - Ajouter un step "Table Input"</p>
            <ol>
                <li>Ajoutez un <strong>Table input</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Lecture_Produits_OLTP</li>
                        <li><strong>Connection :</strong> OLTP_MySQL</li>
                        <li><strong>SQL :</strong></li>
                    </ul>
                    <pre><code>SELECT 
    id_produit,
    nom_produit,
    categorie
FROM produits</code></pre>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">3.3 - Ajouter un step "Select values"</p>
            <ol>
                <li>Ajoutez <strong>Select values</strong> et cr√©ez le lien</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Renommer_Colonnes</li>
                        <li>Renommez : id_produit ‚Üí id_produit_source</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">3.4 - Ajouter un step "Table Output"</p>
            <ol>
                <li>Ajoutez <strong>Table output</strong> et cr√©ez le lien</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Ecriture_DimProduit</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Target table :</strong> DimProduit</li>
                        <li>Cochez <strong>Truncate table</strong></li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">3.5 - Ex√©cuter la transformation</p>
            <p>Cliquez sur <strong>Run</strong> et v√©rifiez que 500 produits sont charg√©s dans DimProduit</p>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> La table DimProduit contient 500 lignes
        </div>

        <h3>üîπ √âtape 4 : Transformation 3 - G√©n√©rer DimDate</h3>

        <p>La dimension date est particuli√®re : elle n'existe pas dans l'OLTP. Nous allons la g√©n√©rer artificiellement pour couvrir la p√©riode 2022-2024.</p>

        <div class="step">
            <p class="step-number">4.1 - Cr√©er une nouvelle transformation</p>
            <ol>
                <li>Cr√©ez une nouvelle transformation et sauvegardez-la : <code>dim_date.ktr</code></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.2 - Ajouter un step "Generate Rows"</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>Input</strong>, trouvez <strong>Generate Rows</strong></li>
                <li>Glissez-d√©posez sur le canvas</li>
                <li>Double-cliquez dessus</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Generer_Lignes</li>
                        <li><strong>Limit :</strong> 1096 (nombre de jours entre 2022-01-01 et 2024-12-31)</li>
                        <li>Dans la section <strong>Fields</strong>, ajoutez un champ :
                            <ul>
                                <li><strong>Name :</strong> compteur</li>
                                <li><strong>Type :</strong> Integer</li>
                                <li><strong>Value :</strong> 0</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.3 - Ajouter un step "Add sequence"</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>Transform</strong>, trouvez <strong>Add sequence</strong></li>
                <li>Glissez-d√©posez et cr√©ez le lien depuis "Generer_Lignes"</li>
                <li>Double-cliquez dessus</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Ajouter_Sequence</li>
                        <li><strong>Value name :</strong> numero_jour</li>
                        <li><strong>Start value :</strong> 0</li>
                        <li><strong>Increment :</strong> 1</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.4 - Ajouter un step "Calculator"</p>
            <ol>
                <li>Trouvez <strong>Calculator</strong> sous <strong>Transform</strong></li>
                <li>Glissez-d√©posez et cr√©ez le lien</li>
                <li>Double-cliquez dessus</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Calculer_Date</li>
                        <li>Ajoutez un calcul :
                            <ul>
                                <li><strong>New field :</strong> date_complete</li>
                                <li><strong>Calculation :</strong> Add days to a date A</li>
                                <li><strong>Field A :</strong> Entrez manuellement "2022-01-01" (date de d√©part)</li>
                                <li><strong>Field B :</strong> numero_jour</li>
                                <li><strong>Value type :</strong> Date</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="note">
            <strong>Note :</strong> Si le Calculator ne propose pas l'option "Add days to a date", utilisez plut√¥t un <strong>Modified Java Script Value</strong> (voir ci-dessous).
        </div>

        <div class="step">
            <p class="step-number">4.5 - Alternative : Utiliser "Modified Java Script Value"</p>
            <p>Si le Calculator ne fonctionne pas, utilisez cette m√©thode :</p>
            <ol>
                <li>Trouvez <strong>Modified Java Script Value</strong> sous <strong>Scripting</strong></li>
                <li>Remplacez le Calculator par ce step</li>
                <li>Double-cliquez dessus</li>
                <li>Dans le champ de script, collez :</li>
            </ol>
            <pre><code>// Cr√©er la date de base (1er janvier 2022)
var date_base = new Date(2022, 0, 1);

// Ajouter le nombre de jours
date_base.setDate(date_base.getDate() + numero_jour);

// Cr√©er la date compl√®te
var date_complete = date_base;

// Extraire les composantes
var annee = date_base.getFullYear();
var mois = date_base.getMonth() + 1;
var jour = date_base.getDate();
var trimestre = Math.ceil(mois / 3);
var jour_semaine = date_base.getDay() == 0 ? 7 : date_base.getDay();

// Calculer id_date_dim (format YYYYMMDD)
var id_date_dim = annee * 10000 + mois * 100 + jour;

// Noms des mois
var noms_mois = ['Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 
                 'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre'];
var nom_mois = noms_mois[mois - 1];

// Noms des jours
var noms_jours = ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'];
var nom_jour = noms_jours[jour_semaine - 1];</code></pre>
                <li>Cliquez sur <strong>Get variables</strong> pour d√©clarer automatiquement les variables de sortie</li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.6 - Ajouter un step "Select values"</p>
            <ol>
                <li>Ajoutez <strong>Select values</strong></li>
                <li>S√©lectionnez uniquement les champs n√©cessaires dans cet ordre :
                    <ul>
                        <li>id_date_dim</li>
                        <li>date_complete</li>
                        <li>annee</li>
                        <li>trimestre</li>
                        <li>mois</li>
                        <li>nom_mois</li>
                        <li>jour</li>
                        <li>jour_semaine</li>
                        <li>nom_jour</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.7 - Ajouter un step "Table Output"</p>
            <ol>
                <li>Ajoutez <strong>Table output</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Ecriture_DimDate</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Target table :</strong> DimDate</li>
                        <li>Cochez <strong>Truncate table</strong></li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.8 - Ex√©cuter la transformation</p>
            <p>Cliquez sur <strong>Run</strong> et v√©rifiez que 1096 dates sont g√©n√©r√©es</p>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> La table DimDate contient 1096 lignes couvrant la p√©riode 2022-2024. V√©rifiez avec : <code>SELECT * FROM ventes_dwh.DimDate ORDER BY date_complete LIMIT 10;</code>
        </div>

        <h3>üîπ √âtape 5 : Transformation 4 - Charger FactVentes (la plus complexe)</h3>

        <p>Cette transformation est la plus importante car elle cr√©e la table de faits en effectuant des jointures entre les donn√©es OLTP et les dimensions du DWH.</p>

        <div class="step">
            <p class="step-number">5.1 - Cr√©er une nouvelle transformation</p>
            <ol>
                <li>Cr√©ez une nouvelle transformation : <code>fact_ventes.ktr</code></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.2 - Extraire les lignes de commandes (source principale)</p>
            <ol>
                <li>Ajoutez un <strong>Table input</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Lecture_Lignes_Commandes</li>
                        <li><strong>Connection :</strong> OLTP_MySQL</li>
                        <li><strong>SQL :</strong></li>
                    </ul>
                    <pre><code>SELECT 
    lc.id_ligne,
    lc.id_commande,
    lc.id_produit,
    lc.quantite,
    lc.prix_unitaire,
    c.id_client,
    c.date_commande
FROM lignes_commandes lc
INNER JOIN commandes c ON lc.id_commande = c.id_commande</code></pre>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.3 - Lookup DimClient (r√©cup√©rer id_client_dim)</p>
            <ol>
                <li>Sous <strong>Lookup</strong>, trouvez <strong>Database lookup</strong></li>
                <li>Glissez-d√©posez et cr√©ez le lien depuis "Lecture_Lignes_Commandes"</li>
                <li>Double-cliquez dessus</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Lookup_Client</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Lookup schema :</strong> (vide)</li>
                        <li><strong>Lookup table :</strong> DimClient</li>
                        <li><strong>Table keys :</strong>
                            <ul>
                                <li><strong>Field :</strong> id_client</li>
                                <li><strong>Comparator :</strong> =</li>
                                <li><strong>Table field :</strong> id_client_source</li>
                            </ul>
                        </li>
                        <li><strong>Return values :</strong>
                            <ul>
                                <li><strong>Field in table :</strong> id_client_dim</li>
                                <li><strong>New name :</strong> id_client_dim</li>
                                <li><strong>Default :</strong> (vide)</li>
                                <li><strong>Type :</strong> Integer</li>
                            </ul>
                        </li>
                        <li>Cochez <strong>Enable cache</strong> pour am√©liorer les performances</li>
                        <li><strong>Cache size :</strong> 10000</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.4 - Lookup DimProduit (r√©cup√©rer id_produit_dim)</p>
            <ol>
                <li>Ajoutez un autre <strong>Database lookup</strong></li>
                <li>Cr√©ez le lien depuis "Lookup_Client"</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Lookup_Produit</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Lookup table :</strong> DimProduit</li>
                        <li><strong>Table keys :</strong>
                            <ul>
                                <li><strong>Field :</strong> id_produit</li>
                                <li><strong>Table field :</strong> id_produit_source</li>
                            </ul>
                        </li>
                        <li><strong>Return values :</strong>
                            <ul>
                                <li><strong>Field in table :</strong> id_produit_dim</li>
                                <li><strong>New name :</strong> id_produit_dim</li>
                            </ul>
                        </li>
                        <li>Cochez <strong>Enable cache</strong>, taille : 500</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.5 - Lookup DimDate (r√©cup√©rer id_date_dim)</p>
            <ol>
                <li>Ajoutez un troisi√®me <strong>Database lookup</strong></li>
                <li>Cr√©ez le lien depuis "Lookup_Produit"</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Lookup_Date</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Lookup table :</strong> DimDate</li>
                        <li><strong>Table keys :</strong>
                            <ul>
                                <li><strong>Field :</strong> date_commande</li>
                                <li><strong>Table field :</strong> date_complete</li>
                            </ul>
                        </li>
                        <li><strong>Return values :</strong>
                            <ul>
                                <li><strong>Field in table :</strong> id_date_dim</li>
                                <li><strong>New name :</strong> id_date_dim</li>
                            </ul>
                        </li>
                        <li>Cochez <strong>Enable cache</strong>, taille : 1100</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.6 - Calculer le montant total</p>
            <ol>
                <li>Ajoutez un <strong>Calculator</strong></li>
                <li>Cr√©ez le lien depuis "Lookup_Date"</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Calculer_Montant</li>
                        <li>Ajoutez un calcul :
                            <ul>
                                <li><strong>New field :</strong> montant_total</li>
                                <li><strong>Calculation :</strong> Multiply A by B (A * B)</li>
                                <li><strong>Field A :</strong> quantite</li>
                                <li><strong>Field B :</strong> prix_unitaire</li>
                                <li><strong>Value type :</strong> Number</li>
                                <li><strong>Decimal symbol :</strong> .</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.7 - S√©lectionner les champs finaux</p>
            <ol>
                <li>Ajoutez un <strong>Select values</strong></li>
                <li>Cr√©ez le lien depuis "Calculer_Montant"</li>
                <li>S√©lectionnez uniquement ces champs dans cet ordre :
                    <ul>
                        <li>id_client_dim</li>
                        <li>id_produit_dim</li>
                        <li>id_date_dim</li>
                        <li>quantite</li>
                        <li>prix_unitaire</li>
                        <li>montant_total</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.8 - √âcrire dans FactVentes</p>
            <ol>
                <li>Ajoutez un <strong>Table output</strong></li>
                <li>Cr√©ez le lien</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Step name :</strong> Ecriture_FactVentes</li>
                        <li><strong>Connection :</strong> DWH_MySQL</li>
                        <li><strong>Target table :</strong> FactVentes</li>
                        <li>Cochez <strong>Truncate table</strong></li>
                        <li><strong>Commit size :</strong> 1000 (pour de meilleures performances)</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="note">
            <strong>Votre transformation doit ressembler √† ceci :</strong><br>
            [Lecture_Lignes_Commandes] ‚Üí [Lookup_Client] ‚Üí [Lookup_Produit] ‚Üí [Lookup_Date] ‚Üí [Calculer_Montant] ‚Üí [Select values] ‚Üí [Ecriture_FactVentes]
        </div>

        <div class="step">
            <p class="step-number">5.9 - Ex√©cuter la transformation</p>
            <ol>
                <li>Cliquez sur <strong>Run</strong></li>
                <li>Cette transformation peut prendre 1-2 minutes car elle traite 100 000 lignes avec 3 lookups</li>
                <li>Observez la progression dans le panneau du bas</li>
            </ol>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> La table FactVentes contient 100 000 lignes. V√©rifiez avec : <code>SELECT COUNT(*) FROM ventes_dwh.FactVentes;</code>
        </div>

        <div class="warning">
            <strong>D√©pannage :</strong>
            <ul>
                <li>Si vous obtenez des erreurs de "null values", v√©rifiez que toutes les dimensions sont bien remplies avant d'ex√©cuter cette transformation</li>
                <li>Si les lookups sont lents, assurez-vous que les index sont bien cr√©√©s dans le DWH</li>
                <li>Si vous avez des erreurs de m√©moire, augmentez la m√©moire de Pentaho dans le fichier <code>Spoon.bat</code> ou <code>spoon.sh</code></li>
            </ul>
        </div>

        <h2>Cr√©ation du Job d'Orchestration Pentaho</h2>

        <p>Maintenant que nous avons cr√©√© les 4 transformations, nous allons les orchestrer dans un <strong>Job</strong> qui les ex√©cutera dans le bon ordre.</p>

        <h3>üîπ Pourquoi un Job ?</h3>
        <p>Un Job permet de :</p>
        <ul>
            <li>Ex√©cuter plusieurs transformations dans un ordre pr√©cis</li>
            <li>G√©rer les d√©pendances entre transformations</li>
            <li>G√©rer les erreurs et les chemins d'ex√©cution conditionnels</li>
            <li>Planifier l'ex√©cution automatique (via cron ou Task Scheduler)</li>
        </ul>

        <div class="step">
            <p class="step-number">√âtape 1 : Cr√©er un nouveau Job</p>
            <ol>
                <li>Dans Pentaho Spoon, cliquez sur <strong>File</strong> ‚Üí <strong>New</strong> ‚Üí <strong>Job</strong></li>
                <li>Sauvegardez imm√©diatement : <code>job_etl_complet.kjb</code></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 2 : Ajouter l'entr√©e START</p>
            <ol>
                <li>Dans le panneau de gauche, sous <strong>General</strong>, trouvez <strong>START</strong></li>
                <li>Glissez-d√©posez sur le canvas (toujours pr√©sent dans un Job)</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 3 : Ajouter la transformation DimClient</p>
            <ol>
                <li>Sous <strong>General</strong>, trouvez <strong>Transformation</strong></li>
                <li>Glissez-d√©posez sur le canvas</li>
                <li>Double-cliquez dessus</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Job entry name :</strong> Charger_DimClient</li>
                        <li>Cliquez sur <strong>Browse</strong> et s√©lectionnez <code>dim_client.ktr</code></li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
                <li>Cr√©ez un lien depuis START vers "Charger_DimClient" (maintenez Shift, cliquez sur START, puis sur la transformation)</li>
                <li>Quand on vous demande le type de lien, choisissez <strong>Unconditional</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 4 : Ajouter la transformation DimProduit</p>
            <ol>
                <li>Ajoutez une autre <strong>Transformation</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Job entry name :</strong> Charger_DimProduit</li>
                        <li>S√©lectionnez <code>dim_produit.ktr</code></li>
                    </ul>
                </li>
                <li>Cr√©ez un lien depuis "Charger_DimClient" vers "Charger_DimProduit"</li>
                <li>Choisissez <strong>Follow when result is true</strong> (ex√©cuter si la pr√©c√©dente r√©ussit)</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 5 : Ajouter la transformation DimDate</p>
            <ol>
                <li>Ajoutez une <strong>Transformation</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Job entry name :</strong> Charger_DimDate</li>
                        <li>S√©lectionnez <code>dim_date.ktr</code></li>
                    </ul>
                </li>
                <li>Cr√©ez un lien depuis "Charger_DimProduit" vers "Charger_DimDate" (type : "true")</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 6 : Ajouter la transformation FactVentes</p>
            <ol>
                <li>Ajoutez une <strong>Transformation</strong></li>
                <li>Configuration :
                    <ul>
                        <li><strong>Job entry name :</strong> Charger_FactVentes</li>
                        <li>S√©lectionnez <code>fact_ventes.ktr</code></li>
                    </ul>
                </li>
                <li>Cr√©ez un lien depuis "Charger_DimDate" vers "Charger_FactVentes" (type : "true")</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">√âtape 7 : Ajouter un message de succ√®s (optionnel)</p>
            <ol>
                <li>Sous <strong>Utility</strong>, trouvez <strong>Write to log</strong></li>
                <li>Glissez-d√©posez sur le canvas</li>
                <li>Configuration :
                    <ul>
                        <li><strong>Job entry name :</strong> Message_Succes</li>
                        <li><strong>Log level :</strong> Basic</li>
                        <li><strong>Log subject :</strong> ETL Complet</li>
                        <li><strong>Log message :</strong> Toutes les transformations ont √©t√© ex√©cut√©es avec succ√®s ! Le Data Warehouse est √† jour.</li>
                    </ul>
                </li>
                <li>Cr√©ez un lien depuis "Charger_FactVentes" vers "Message_Succes"</li>
            </ol>
        </div>

        <div class="note">
            <strong>Structure du Job :</strong><br>
            START ‚Üí Charger_DimClient ‚Üí Charger_DimProduit ‚Üí Charger_DimDate ‚Üí Charger_FactVentes ‚Üí Message_Succes
        </div>

        <div class="step">
            <p class="step-number">√âtape 8 : Ex√©cuter le Job complet</p>
            <ol>
                <li>Cliquez sur le bouton <strong>Run</strong> (ic√¥ne "Play" verte)</li>
                <li>Cliquez sur <strong>Launch</strong></li>
                <li>Observez l'ex√©cution s√©quentielle de toutes les transformations</li>
                <li>Le Job prend environ 2-3 minutes pour s'ex√©cuter compl√®tement</li>
            </ol>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Toutes les √©tapes sont vertes, et vous voyez le message de succ√®s dans les logs. Votre Data Warehouse est maintenant compl√®tement rempli !
        </div>

        <h3>üîπ Planification automatique (Bonus)</h3>

        <p>Pour ex√©cuter ce Job automatiquement tous les jours √† minuit, vous pouvez utiliser :</p>

        <h4>Sous Windows (Task Scheduler)</h4>
        <pre><code>"C:\Pentaho\data-integration\Kitchen.bat" /file:"C:\chemin\vers\job_etl_complet.kjb" /level:Basic</code></pre>

        <h4>Sous Linux/Mac (cron)</h4>
        <pre><code># Ouvrir crontab
crontab -e

# Ajouter cette ligne pour ex√©cuter √† minuit tous les jours
0 0 * * * /opt/pentaho/data-integration/kitchen.sh -file=/chemin/vers/job_etl_complet.kjb -level=Basic</code></pre>

        <h2>Requ√™tes OLAP sur le Data Warehouse</h2>

        <p>Maintenant que notre Data Warehouse est rempli, nous allons l'interroger pour r√©pondre aux questions m√©tier.</p>

        <div class="note">
            <strong>Important :</strong> Toutes les requ√™tes OLAP doivent s'ex√©cuter dans <strong>MySQL Workbench</strong> ‚Üí s√©lectionner la base <strong>¬´ ventes_dwh ¬ª</strong> ‚Üí ex√©cuter les requ√™tes SQL ci-dessous.
        </div>

        <div class="step">
            <p class="step-number">√âtape pr√©alable</p>
            <p>Ouvrez MySQL Workbench, connectez-vous √† votre serveur, et s√©lectionnez la base de donn√©es :</p>
            <pre><code>USE ventes_dwh;</code></pre>
        </div>

        <h3>üîπ Requ√™te 1 : Chiffre d'affaires par ville</h3>

        <p>Cette requ√™te permet d'identifier les villes g√©n√©rant le plus de revenus.</p>

        <pre><code>SELECT 
    c.ville,
    SUM(f.montant_total) AS chiffre_affaires,
    COUNT(DISTINCT f.id_client_dim) AS nombre_clients,
    COUNT(f.id_vente) AS nombre_ventes
FROM FactVentes f
INNER JOIN DimClient c ON f.id_client_dim = c.id_client_dim
GROUP BY c.ville
ORDER BY chiffre_affaires DESC;</code></pre>

        <p><strong>Interpr√©tation :</strong> Cette requ√™te agr√®ge les ventes par ville. Elle permet de concentrer les efforts marketing sur les villes les plus rentables. Par exemple, si Paris g√©n√®re 35% du CA, l'entreprise pourrait y ouvrir un showroom physique.</p>

        <h3>üîπ Requ√™te 2 : Chiffre d'affaires par cat√©gorie de produit</h3>

        <p>Permet d'identifier les cat√©gories de produits les plus performantes.</p>

        <pre><code>SELECT 
    p.categorie,
    SUM(f.montant_total) AS chiffre_affaires,
    SUM(f.quantite) AS quantite_vendue,
    COUNT(DISTINCT f.id_produit_dim) AS nombre_produits_distincts,
    ROUND(AVG(f.prix_unitaire), 2) AS prix_moyen
FROM FactVentes f
INNER JOIN DimProduit p ON f.id_produit_dim = p.id_produit_dim
GROUP BY p.categorie
ORDER BY chiffre_affaires DESC;</code></pre>

        <p><strong>Interpr√©tation :</strong> Si la cat√©gorie "Ordinateurs" repr√©sente 45% du CA, cela justifie d'√©largir cette gamme de produits. √Ä l'inverse, une cat√©gorie peu vendue pourrait √™tre abandonn√©e ou promue diff√©remment.</p>

        <h3>üîπ Requ√™te 3 : √âvolution des ventes par mois</h3>

        <p>Analyse de la tendance temporelle des ventes.</p>

        <pre><code>SELECT 
    d.annee,
    d.mois,
    d.nom_mois,
    SUM(f.montant_total) AS chiffre_affaires,
    COUNT(f.id_vente) AS nombre_ventes,
    ROUND(AVG(f.montant_total), 2) AS panier_moyen
FROM FactVentes f
INNER JOIN DimDate d ON f.id_date_dim = d.id_date_dim
GROUP BY d.annee, d.mois, d.nom_mois
ORDER BY d.annee, d.mois;</code></pre>

        <p><strong>Interpr√©tation :</strong> Cette requ√™te r√©v√®le la saisonnalit√© des ventes. Par exemple, un pic en d√©cembre indique l'effet des f√™tes de fin d'ann√©e, sugg√©rant d'augmenter le stock et les campagnes publicitaires en novembre-d√©cembre.</p>

        <h3>üîπ Requ√™te 4 : Top 10 des produits les plus vendus</h3>

        <p>Identifie les produits stars du catalogue.</p>

        <pre><code>SELECT 
    p.nom_produit,
    p.categorie,
    SUM(f.quantite) AS quantite_totale_vendue,
    SUM(f.montant_total) AS chiffre_affaires,
    ROUND(AVG(f.prix_unitaire), 2) AS prix_moyen
FROM FactVentes f
INNER JOIN DimProduit p ON f.id_produit_dim = p.id_produit_dim
GROUP BY p.id_produit_dim, p.nom_produit, p.categorie
ORDER BY quantite_totale_vendue DESC
LIMIT 10;</code></pre>

        <p><strong>Interpr√©tation :</strong> Les 10 produits les plus vendus repr√©sentent souvent une part disproportionn√©e du CA (principe de Pareto 80/20). Ces produits doivent toujours √™tre en stock et mis en avant sur le site web.</p>

        <h3>üîπ Requ√™te 5 : Analyse par trimestre et cat√©gorie (analyse crois√©e)</h3>

        <p>Analyse multidimensionnelle combinant temps et cat√©gorie.</p>

        <pre><code>SELECT 
    d.annee,
    d.trimestre,
    p.categorie,
    SUM(f.montant_total) AS chiffre_affaires,
    SUM(f.quantite) AS quantite_vendue
FROM FactVentes f
INNER JOIN DimDate d ON f.id_date_dim = d.id_date_dim
INNER JOIN DimProduit p ON f.id_produit_dim = p.id_produit_dim
GROUP BY d.annee, d.trimestre, p.categorie
ORDER BY d.annee, d.trimestre, chiffre_affaires DESC;</code></pre>

        <p><strong>Interpr√©tation :</strong> Cette requ√™te r√©v√®le quelles cat√©gories performent √† quels moments de l'ann√©e. Par exemple, les "Tablettes" peuvent mieux se vendre au Q3 (rentr√©e scolaire) tandis que les "Montres" performent au Q4 (cadeaux de No√´l).</p>

        <div class="success">
            <strong>Avantages du sch√©ma en √©toile :</strong>
            <ul>
                <li>Toutes ces requ√™tes sont <strong>tr√®s rapides</strong> malgr√© les 100 000 lignes</li>
                <li>La syntaxe SQL est <strong>simple et lisible</strong></li>
                <li>Chaque requ√™te n√©cessite seulement <strong>1 ou 2 jointures</strong></li>
                <li>Les dimensions enrichissent naturellement l'analyse (noms de mois, cat√©gories, villes)</li>
            </ul>
        </div>

        <h2>Power BI - Reporting et Visualisation</h2>

        <p>Nous allons maintenant cr√©er un tableau de bord interactif dans Power BI pour visualiser nos donn√©es du Data Warehouse.</p>

        <div class="warning">
            <strong>Pr√©requis :</strong> T√©l√©chargez et installez <strong>Power BI Desktop</strong> (gratuit) depuis le site de Microsoft. Assurez-vous √©galement d'avoir le connecteur MySQL pour Power BI.
        </div>

        <h3>üîπ √âtape 1 : Se connecter √† MySQL depuis Power BI</h3>

        <div class="step">
            <p class="step-number">1.1 - Lancer Power BI Desktop</p>
            <p>Ouvrez Power BI Desktop. √Ä l'√©cran d'accueil, vous verrez diverses options.</p>
        </div>

        <div class="step">
            <p class="step-number">1.2 - Obtenir les donn√©es</p>
            <ol>
                <li>Cliquez sur <strong>Obtenir des donn√©es</strong> (Get Data) dans le ruban Accueil</li>
                <li>Dans la liste, recherchez <strong>MySQL database</strong></li>
                <li>S√©lectionnez-le et cliquez sur <strong>Connexion</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">1.3 - Configurer la connexion</p>
            <ol>
                <li>Dans la fen√™tre de connexion, remplissez :
                    <ul>
                        <li><strong>Serveur :</strong> localhost</li>
                        <li><strong>Base de donn√©es :</strong> ventes_dwh</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>OK</strong></li>
                <li>S√©lectionnez l'onglet <strong>Base de donn√©es</strong></li>
                <li>Entrez vos identifiants MySQL :
                    <ul>
                        <li><strong>Nom d'utilisateur :</strong> root (ou votre user)</li>
                        <li><strong>Mot de passe :</strong> votre mot de passe MySQL</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>Connexion</strong></li>
            </ol>
        </div>

        <div class="note">
            <strong>Note :</strong> Si Power BI vous demande d'installer le connecteur MySQL, suivez les instructions pour t√©l√©charger et installer le pilote MySQL Connector/NET depuis le site d'Oracle.
        </div>

        <h3>üîπ √âtape 2 : Importer les tables du Data Warehouse</h3>

        <div class="step">
            <p class="step-number">2.1 - S√©lectionner les tables</p>
            <ol>
                <li>Dans la fen√™tre Navigateur qui s'affiche, vous voyez la liste des tables de ventes_dwh</li>
                <li>Cochez les 4 tables :
                    <ul>
                        <li>‚òë DimClient</li>
                        <li>‚òë DimProduit</li>
                        <li>‚òë DimDate</li>
                        <li>‚òë FactVentes</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>Charger</strong> (Load)</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">2.2 - Attendre le chargement</p>
            <p>Power BI importe les donn√©es. Cela peut prendre 30 secondes √† 1 minute pour les 100 000 lignes de FactVentes.</p>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Dans le panneau de droite "Champs" (Fields), vous voyez maintenant les 4 tables avec leurs colonnes respectives.
        </div>

        <h3>üîπ √âtape 3 : V√©rifier et configurer le mod√®le de donn√©es</h3>

        <div class="step">
            <p class="step-number">3.1 - Ouvrir la vue Mod√®le</p>
            <ol>
                <li>Sur le c√¥t√© gauche, cliquez sur l'ic√¥ne <strong>Mod√®le</strong> (trois tables reli√©es)</li>
                <li>Vous voyez un diagramme avec les 4 tables</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">3.2 - V√©rifier les relations automatiques</p>
            <p>Power BI devrait avoir d√©tect√© automatiquement les relations gr√¢ce aux cl√©s √©trang√®res :</p>
            <ul>
                <li>FactVentes.id_client_dim ‚Üî DimClient.id_client_dim</li>
                <li>FactVentes.id_produit_dim ‚Üî DimProduit.id_produit_dim</li>
                <li>FactVentes.id_date_dim ‚Üî DimDate.id_date_dim</li>
            </ul>
            <p>Ces relations sont repr√©sent√©es par des lignes entre les tables.</p>
        </div>

        <div class="step">
            <p class="step-number">3.3 - Cr√©er manuellement une relation (si n√©cessaire)</p>
            <p>Si une relation manque :</p>
            <ol>
                <li>Cliquez sur <strong>G√©rer les relations</strong> dans le ruban</li>
                <li>Cliquez sur <strong>Nouvelle</strong></li>
                <li>S√©lectionnez la table et la colonne source, puis la table et la colonne cible</li>
                <li>Assurez-vous que la <strong>Cardinalit√©</strong> est "Plusieurs √† un (*:1)"</li>
                <li>Cliquez sur <strong>OK</strong></li>
            </ol>
        </div>

        <div class="note">
            <strong>Structure attendue :</strong><br>
            Votre mod√®le doit ressembler √† un sch√©ma en √©toile : FactVentes au centre, avec les trois dimensions (DimClient, DimProduit, DimDate) autour, reli√©es par des lignes.
        </div>

        <h3>üîπ √âtape 4 : Cr√©er les visualisations</h3>

        <p>Revenons √† la vue Rapport (ic√¥ne graphique √† gauche) pour cr√©er nos visuels.</p>

        <h4>Visuel 1 : Chiffre d'affaires par ville (Graphique √† barres)</h4>

        <div class="step">
            <p class="step-number">4.1 - Ajouter un graphique √† barres</p>
            <ol>
                <li>Cliquez sur une zone vide du canevas</li>
                <li>Dans le panneau <strong>Visualisations</strong> (√† droite), cliquez sur l'ic√¥ne <strong>Graphique √† barres group√©es</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.2 - Configurer les champs</p>
            <ol>
                <li>Dans le panneau <strong>Champs</strong>, d√©pliez <strong>DimClient</strong></li>
                <li>Glissez <strong>ville</strong> vers <strong>Axe</strong> (ou Axe Y)</li>
                <li>D√©pliez <strong>FactVentes</strong></li>
                <li>Glissez <strong>montant_total</strong> vers <strong>Valeurs</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.3 - Personnaliser</p>
            <ol>
                <li>Dans le panneau Visualisations, cliquez sur l'ic√¥ne <strong>Format</strong> (rouleau de peinture)</li>
                <li>Ajoutez un titre : "Chiffre d'affaires par ville"</li>
                <li>Activez les <strong>√âtiquettes de donn√©es</strong> pour afficher les montants sur les barres</li>
                <li>Changez les couleurs si souhait√©</li>
            </ol>
        </div>

        <div class="note">
            <strong>Interpr√©tation :</strong> Ce graphique montre instantan√©ment quelle ville g√©n√®re le plus de revenus. Paris, Lyon et Marseille appara√Ætront probablement en t√™te. Les d√©cideurs peuvent utiliser cette information pour allouer les budgets marketing g√©ographiquement.
        </div>

        <h4>Visuel 2 : Chiffre d'affaires par cat√©gorie (Graphique en secteurs)</h4>

        <div class="step">
            <p class="step-number">4.4 - Ajouter un graphique en secteurs</p>
            <ol>
                <li>Cliquez sur une zone vide du canevas</li>
                <li>S√©lectionnez l'ic√¥ne <strong>Graphique en secteurs</strong> (Pie chart)</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.5 - Configurer les champs</p>
            <ol>
                <li>Glissez <strong>DimProduit.categorie</strong> vers <strong>L√©gende</strong></li>
                <li>Glissez <strong>FactVentes.montant_total</strong> vers <strong>Valeurs</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.6 - Personnaliser</p>
            <ol>
                <li>Ajoutez un titre : "R√©partition du CA par cat√©gorie"</li>
                <li>Activez les <strong>√âtiquettes de d√©tails</strong> pour afficher les pourcentages</li>
                <li>Personnalisez les couleurs pour diff√©rencier les cat√©gories</li>
            </ol>
        </div>

        <div class="note">
            <strong>Interpr√©tation :</strong> Le graphique en secteurs r√©v√®le la contribution relative de chaque cat√©gorie au CA total. Si "Ordinateurs" repr√©sente 40% du camembert, c'est la cat√©gorie strat√©gique √† ne jamais laisser en rupture de stock.
        </div>

        <h4>Visuel 3 : √âvolution des ventes mensuelles (Graphique en courbes)</h4>

        <div class="step">
            <p class="step-number">4.7 - Ajouter un graphique en courbes</p>
            <ol>
                <li>Cliquez sur une zone vide</li>
                <li>S√©lectionnez <strong>Graphique en courbes</strong> (Line chart)</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.8 - Configurer les champs</p>
            <ol>
                <li>Glissez <strong>DimDate.date_complete</strong> vers <strong>Axe X</strong></li>
                <li>Glissez <strong>FactVentes.montant_total</strong> vers <strong>Valeurs</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.9 - Configurer la hi√©rarchie temporelle</p>
            <ol>
                <li>Cliquez sur la petite fl√®che √† c√¥t√© de "date_complete" dans l'axe</li>
                <li>S√©lectionnez le niveau de granularit√© souhait√© :
                    <ul>
                        <li>Ann√©e ‚Üí pour une vue macro</li>
                        <li>Ann√©e > Trimestre ‚Üí pour voir les tendances trimestrielles</li>
                        <li>Ann√©e > Mois ‚Üí pour l'√©volution mensuelle (recommand√©)</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.10 - Personnaliser</p>
            <ol>
                <li>Titre : "√âvolution mensuelle du chiffre d'affaires"</li>
                <li>Activez les <strong>Marqueurs</strong> pour voir les points sur la courbe</li>
                <li>Ajoutez une couleur distinctive (ex : bleu fonc√©)</li>
            </ol>
        </div>

        <div class="note">
            <strong>Interpr√©tation :</strong> La courbe r√©v√®le la saisonnalit√© et les tendances. Une croissance constante indique une bonne sant√© commerciale. Des pics r√©guliers (ex : d√©cembre) sugg√®rent des opportunit√©s de campagnes cibl√©es.
        </div>

        <h4>Visuel 4 : Top 10 des produits (Graphique √† barres horizontales)</h4>

        <div class="step">
            <p class="step-number">4.11 - Ajouter un graphique √† barres</p>
            <ol>
                <li>Cliquez sur une zone vide</li>
                <li>S√©lectionnez <strong>Graphique √† barres horizontales</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.12 - Configurer les champs</p>
            <ol>
                <li>Glissez <strong>DimProduit.nom_produit</strong> vers <strong>Axe Y</strong></li>
                <li>Glissez <strong>FactVentes.quantite</strong> vers <strong>Valeurs</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.13 - Limiter au Top 10</p>
            <ol>
                <li>Cliquez sur le visuel pour le s√©lectionner</li>
                <li>Dans le panneau Visualisations, allez dans <strong>Filtres</strong></li>
                <li>Trouvez le filtre sur <strong>nom_produit</strong></li>
                <li>Changez le type de filtre en <strong>Top N</strong></li>
                <li>Configurez :
                    <ul>
                        <li><strong>Afficher les √©l√©ments :</strong> Top 10</li>
                        <li><strong>Par valeur :</strong> Somme de quantite</li>
                    </ul>
                </li>
                <li>Cliquez sur <strong>Appliquer le filtre</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">4.14 - Personnaliser</p>
            <ol>
                <li>Titre : "Top 10 des produits les plus vendus"</li>
                <li>Triez les barres par ordre d√©croissant</li>
                <li>Activez les √©tiquettes de donn√©es</li>
            </ol>
        </div>

        <div class="note">
            <strong>Interpr√©tation :</strong> Ce visuel identifie les produits stars. Ces produits doivent √™tre mis en avant sur la page d'accueil du site et b√©n√©ficier de promotions pour maximiser les ventes.
        </div>

        <h3>üîπ √âtape 5 : Ajouter des segments (Slicers) pour l'interactivit√©</h3>

        <p>Les segments permettent de filtrer dynamiquement tous les visuels du rapport.</p>

        <div class="step">
            <p class="step-number">5.1 - Ajouter un segment Ann√©e</p>
            <ol>
                <li>Cliquez sur une zone vide</li>
                <li>S√©lectionnez l'ic√¥ne <strong>Segment</strong> (Slicer) dans les visualisations</li>
                <li>Glissez <strong>DimDate.annee</strong> vers <strong>Champ</strong></li>
                <li>Positionnez ce segment en haut √† gauche du rapport</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.2 - Ajouter un segment Cat√©gorie</p>
            <ol>
                <li>Ajoutez un autre <strong>Segment</strong></li>
                <li>Glissez <strong>DimProduit.categorie</strong> vers <strong>Champ</strong></li>
                <li>Positionnez-le √† c√¥t√© du segment Ann√©e</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">5.3 - Tester l'interactivit√©</p>
            <ol>
                <li>Cliquez sur "2023" dans le segment Ann√©e : tous les visuels se mettent √† jour pour afficher uniquement les donn√©es 2023</li>
                <li>Cliquez sur "Ordinateurs" dans le segment Cat√©gorie : les visuels se filtrent encore plus</li>
                <li>Cliquez sur une barre du graphique "CA par ville" : tous les autres visuels se filtrent pour cette ville</li>
            </ol>
        </div>

        <div class="note">
            <strong>Note:</strong> Cette interactivit√© bidirectionnelle (cross-filtering) est l'une des forces majeures de Power BI. Elle permet aux utilisateurs d'explorer les donn√©es de mani√®re intuitive sans √©crire de SQL.
        </div>

        <h3>üîπ √âtape 6 : Cr√©er des mesures DAX (optionnel mais recommand√©)</h3>

        <p>Pour enrichir l'analyse, cr√©ons quelques mesures calcul√©es avec le langage DAX.</p>

        <div class="step">
            <p class="step-number">6.1 - Cr√©er une mesure "CA Total"</p>
            <ol>
                <li>Dans le panneau Champs, clic droit sur <strong>FactVentes</strong></li>
                <li>S√©lectionnez <strong>Nouvelle mesure</strong></li><li>Dans la barre de formule qui appara√Æt, tapez :</li>
            </ol>
            <pre><code>CA Total = SUM(FactVentes[montant_total])</code></pre>
            <ol start="4">
                <li>Appuyez sur <strong>Entr√©e</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">6.2 - Cr√©er une mesure "Nombre de ventes"</p>
            <ol>
                <li>Clic droit sur <strong>FactVentes</strong> ‚Üí <strong>Nouvelle mesure</strong></li>
                <li>Tapez :</li>
            </ol>
            <pre><code>Nombre de Ventes = COUNT(FactVentes[id_vente])</code></pre>
        </div>

        <div class="step">
            <p class="step-number">6.3 - Cr√©er une mesure "Panier Moyen"</p>
            <ol>
                <li>Nouvelle mesure :</li>
            </ol>
            <pre><code>Panier Moyen = DIVIDE([CA Total], [Nombre de Ventes], 0)</code></pre>
            <p>La fonction DIVIDE g√®re automatiquement les divisions par z√©ro</p>
        </div>

        <div class="step">
            <p class="step-number">6.4 - Cr√©er une mesure "Nombre de clients uniques"</p>
            <ol>
                <li>Nouvelle mesure :</li>
            </ol>
            <pre><code>Clients Uniques = DISTINCTCOUNT(FactVentes[id_client_dim])</code></pre>
        </div>

        <div class="step">
            <p class="step-number">6.5 - Utiliser les mesures</p>
            <ol>
                <li>Cr√©ez une <strong>Carte</strong> (Card) pour afficher le CA Total</li>
                <li>Cr√©ez une autre carte pour le Panier Moyen</li>
                <li>Cr√©ez une carte pour Nombre de Ventes</li>
                <li>Cr√©ez une carte pour Clients Uniques</li>
                <li>Positionnez ces 4 cartes en haut du rapport comme des KPI</li>
            </ol>
        </div>

        <div class="success">
            <strong>R√©sultat attendu :</strong> Vous avez maintenant un tableau de bord complet avec :
            <ul>
                <li>4 cartes KPI en haut (CA Total, Panier Moyen, Nombre de Ventes, Clients Uniques)</li>
                <li>2 segments interactifs (Ann√©e, Cat√©gorie)</li>
                <li>4 visualisations principales (CA par ville, CA par cat√©gorie, √âvolution mensuelle, Top 10 produits)</li>
                <li>Interactivit√© compl√®te entre tous les visuels</li>
            </ul>
        </div>

        <h3>üîπ √âtape 7 : Mise en forme et design professionnel</h3>

        <div class="step">
            <p class="step-number">7.1 - Choisir un th√®me</p>
            <ol>
                <li>Dans le ruban <strong>Affichage</strong>, cliquez sur <strong>Th√®mes</strong></li>
                <li>S√©lectionnez un th√®me professionnel (ex : "Executive")</li>
                <li>Tous les visuels adoptent automatiquement les couleurs du th√®me</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">7.2 - Ajouter un titre au rapport</p>
            <ol>
                <li>Dans le ruban <strong>Insertion</strong>, cliquez sur <strong>Zone de texte</strong></li>
                <li>Tapez : "Dashboard Ventes TechStore - Analyse E-commerce"</li>
                <li>Formatez en grand, gras, couleur de th√®me</li>
                <li>Positionnez en haut du rapport</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">7.3 - Aligner les visuels</p>
            <ol>
                <li>S√©lectionnez plusieurs visuels (maintenez Ctrl)</li>
                <li>Dans le ruban <strong>Format</strong>, utilisez les options <strong>Aligner</strong></li>
                <li>Utilisez <strong>Distribuer horizontalement</strong> et <strong>Distribuer verticalement</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">7.4 - Ajuster les tailles</p>
            <ol>
                <li>Les KPI (cartes) doivent √™tre petits et align√©s horizontalement</li>
                <li>Les graphiques principaux doivent occuper l'espace restant de mani√®re √©quilibr√©e</li>
                <li>Laissez des marges entre les visuels pour une meilleure lisibilit√©</li>
            </ol>
        </div>

        <h3>üîπ √âtape 8 : Sauvegarder et partager</h3>

        <div class="step">
            <p class="step-number">8.1 - Sauvegarder le fichier</p>
            <ol>
                <li>Cliquez sur <strong>Fichier</strong> ‚Üí <strong>Enregistrer</strong></li>
                <li>Nommez le fichier : <code>Dashboard_Ventes_TechStore.pbix</code></li>
                <li>Choisissez un emplacement appropri√©</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">8.2 - Exporter en PDF</p>
            <ol>
                <li>Cliquez sur <strong>Fichier</strong> ‚Üí <strong>Exporter</strong> ‚Üí <strong>Exporter au format PDF</strong></li>
                <li>Configurez les options d'export</li>
                <li>Cliquez sur <strong>Exporter</strong></li>
                <li>Ce PDF peut √™tre partag√© avec les d√©cideurs</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">8.3 - Publier sur Power BI Service (optionnel)</p>
            <ol>
                <li>Si vous avez un compte Power BI, cliquez sur <strong>Publier</strong></li>
                <li>S√©lectionnez un espace de travail</li>
                <li>Le rapport sera accessible en ligne et partageable par lien</li>
                <li>Vous pourrez configurer des rafra√Æchissements automatiques des donn√©es</li>
            </ol>
        </div>

        <div class="note">
            <strong>Bonnes pratiques Power BI :</strong>
            <ul>
                <li><strong>Limiter le nombre de visuels :</strong> 5-8 par page maximum pour √©viter la surcharge cognitive</li>
                <li><strong>Utiliser des couleurs coh√©rentes :</strong> Appliquer un th√®me et s'y tenir</li>
                <li><strong>Prioriser les KPI :</strong> Les m√©triques importantes doivent √™tre visibles en premier</li>
                <li><strong>Ajouter des info-bulles :</strong> Expliquer les m√©triques complexes avec des tooltips</li>
                <li><strong>Tester l'interactivit√© :</strong> V√©rifier que les filtres fonctionnent correctement</li>
                <li><strong>Optimiser les performances :</strong> Limiter les mesures DAX complexes si le rapport est lent</li>
            </ul>
        </div>

        <h3>üîπ √âtape 9 : Cr√©er une page de d√©tails (drill-through)</h3>

        <p>Pour une analyse approfondie, cr√©ons une page de d√©tails accessible en cliquant sur un √©l√©ment.</p>

        <div class="step">
            <p class="step-number">9.1 - Cr√©er une nouvelle page</p>
            <ol>
                <li>En bas de l'√©cran, cliquez sur le <strong>+</strong> pour ajouter une page</li>
                <li>Renommez-la "D√©tails Produit"</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">9.2 - Configurer le drill-through</p>
            <ol>
                <li>Dans le panneau Visualisations, trouvez la section <strong>Filtres de la page</strong></li>
                <li>Glissez <strong>DimProduit.nom_produit</strong> vers la zone <strong>Drill-through</strong></li>
                <li>Cochez <strong>Conserver tous les filtres</strong></li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">9.3 - Ajouter des visuels d√©taill√©s</p>
            <ol>
                <li>Ajoutez un <strong>Tableau</strong> montrant toutes les ventes du produit s√©lectionn√©</li>
                <li>Ajoutez un graphique en courbes de l'√©volution des ventes de ce produit dans le temps</li>
                <li>Ajoutez une carte montrant le CA total du produit</li>
            </ol>
        </div>

        <div class="step">
            <p class="step-number">9.4 - Tester le drill-through</p>
            <ol>
                <li>Revenez √† la premi√®re page</li>
                <li>Clic droit sur une barre du Top 10 produits</li>
                <li>S√©lectionnez <strong>Drill-through</strong> ‚Üí <strong>D√©tails Produit</strong></li>
                <li>La page de d√©tails s'affiche, filtr√©e sur le produit s√©lectionn√©</li>
                <li>Cliquez sur la fl√®che de retour en haut √† gauche pour revenir</li>
            </ol>
        </div>

        <div class="success">
            <strong>Fonctionnalit√© avanc√©e :</strong> Le drill-through permet aux utilisateurs d'explorer les donn√©es en profondeur sans surcharger le tableau de bord principal. C'est une fonctionnalit√© tr√®s appr√©ci√©e par les analystes m√©tier.
        </div>

        <h2>Livrables du TP</h2>

        <p>√Ä la fin de ce TP, vous devez avoir produit et sauvegard√© les fichiers suivants :</p>

        <table>
            <tr>
                <th>Cat√©gorie</th>
                <th>Fichier</th>
                <th>Description</th>
                <th>Emplacement</th>
            </tr>
            <tr>
                <td rowspan="4"><strong>Scripts SQL</strong></td>
                <td>01_create_oltp.sql</td>
                <td>Script de cr√©ation de la base OLTP</td>
                <td>/sql/</td>
            </tr>
            <tr>
                <td>02_create_dwh.sql</td>
                <td>Script de cr√©ation du Data Warehouse</td>
                <td>/sql/</td>
            </tr>
            <tr>
                <td>03_queries_olap.sql</td>
                <td>Requ√™tes d'analyse OLAP</td>
                <td>/sql/</td>
            </tr>
            <tr>
                <td>04_verification.sql</td>
                <td>Requ√™tes de v√©rification des donn√©es</td>
                <td>/sql/</td>
            </tr>
            <tr>
                <td rowspan="4"><strong>Fichiers CSV</strong></td>
                <td>clients.csv</td>
                <td>10 000 clients g√©n√©r√©s</td>
                <td>/data/</td>
            </tr>
            <tr>
                <td>produits.csv</td>
                <td>500 produits g√©n√©r√©s</td>
                <td>/data/</td>
            </tr>
            <tr>
                <td>commandes.csv</td>
                <td>20 000 commandes g√©n√©r√©es</td>
                <td>/data/</td>
            </tr>
            <tr>
                <td>lignes_commandes.csv</td>
                <td>100 000 lignes de commandes</td>
                <td>/data/</td>
            </tr>
            <tr>
                <td><strong>Script Python</strong></td>
                <td>generate_data.py</td>
                <td>Script de g√©n√©ration des donn√©es</td>
                <td>/scripts/</td>
            </tr>
            <tr>
                <td rowspan="4"><strong>Pentaho Transformations</strong></td>
                <td>dim_client.ktr</td>
                <td>Transformation pour DimClient</td>
                <td>/pentaho/transformations/</td>
            </tr>
            <tr>
                <td>dim_produit.ktr</td>
                <td>Transformation pour DimProduit</td>
                <td>/pentaho/transformations/</td>
            </tr>
            <tr>
                <td>dim_date.ktr</td>
                <td>Transformation pour DimDate</td>
                <td>/pentaho/transformations/</td>
            </tr>
            <tr>
                <td>fact_ventes.ktr</td>
                <td>Transformation pour FactVentes</td>
                <td>/pentaho/transformations/</td>
            </tr>
            <tr>
                <td><strong>Pentaho Job</strong></td>
                <td>job_etl_complet.kjb</td>
                <td>Job d'orchestration complet</td>
                <td>/pentaho/jobs/</td>
            </tr>
            <tr>
                <td><strong>Power BI</strong></td>
                <td>Dashboard_Ventes_TechStore.pbix</td>
                <td>Rapport Power BI interactif</td>
                <td>/powerbi/</td>
            </tr>
            <tr>
                <td><strong>Documentation</strong></td>
                <td>Dashboard_Ventes_TechStore.pdf</td>
                <td>Export PDF du dashboard</td>
                <td>/documentation/</td>
            </tr>
            <tr>
                <td><strong>Rapport Final</strong></td>
                <td>Rapport_TP_BI.pdf</td>
                <td>Document expliquant votre d√©marche et vos conclusions</td>
                <td>/documentation/</td>
            </tr>
        </table>

        <h3>üîπ Structure de dossiers recommand√©e</h3>

        <pre><code>TP_Pipeline_OLTP_ETL_DWH_PowerBI/
‚îÇ
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ 01_create_oltp.sql
‚îÇ   ‚îú‚îÄ‚îÄ 02_create_dwh.sql
‚îÇ   ‚îú‚îÄ‚îÄ 03_queries_olap.sql
‚îÇ   ‚îî‚îÄ‚îÄ 04_verification.sql
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ clients.csv
‚îÇ   ‚îú‚îÄ‚îÄ produits.csv
‚îÇ   ‚îú‚îÄ‚îÄ commandes.csv
‚îÇ   ‚îî‚îÄ‚îÄ lignes_commandes.csv
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ generate_data.py
‚îÇ
‚îú‚îÄ‚îÄ pentaho/
‚îÇ   ‚îú‚îÄ‚îÄ transformations/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dim_client.ktr
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dim_produit.ktr
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dim_date.ktr
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ fact_ventes.ktr
‚îÇ   ‚îî‚îÄ‚îÄ jobs/
‚îÇ       ‚îî‚îÄ‚îÄ job_etl_complet.kjb
‚îÇ
‚îú‚îÄ‚îÄ powerbi/
‚îÇ   ‚îî‚îÄ‚îÄ Dashboard_Ventes_TechStore.pbix
‚îÇ
‚îú‚îÄ‚îÄ documentation/
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard_Ventes_TechStore.pdf
‚îÇ   ‚îú‚îÄ‚îÄ Rapport_TP_BI.pdf
‚îÇ   ‚îî‚îÄ‚îÄ Captures_Ecran/
‚îÇ       ‚îú‚îÄ‚îÄ pentaho_dim_client.png
‚îÇ       ‚îú‚îÄ‚îÄ pentaho_fact_ventes.png
‚îÇ       ‚îú‚îÄ‚îÄ powerbi_dashboard.png
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ README.md</code></pre>

        <h3>üîπ Contenu du rapport final</h3>

        <p>Votre rapport PDF final (Rapport_TP_BI.pdf) doit contenir :</p>

        <ol>
            <li><strong>Page de garde</strong> : Titre, nom, date, formation</li>
            <li><strong>R√©sum√© ex√©cutif</strong> (1 page) : Vue d'ensemble du projet, objectifs, r√©sultats cl√©s</li>
            <li><strong>Introduction</strong> : Contexte de TechStore, probl√©matique m√©tier</li>
            <li><strong>Architecture technique</strong> : Diagramme de l'architecture, technologies utilis√©es</li>
            <li><strong>Mod√©lisation OLTP</strong> : Description des tables, ERD, justification des choix</li>
            <li><strong>G√©n√©ration des donn√©es</strong> : M√©thodologie, volumes, r√©partition</li>
            <li><strong>Mod√©lisation du DWH</strong> : Sch√©ma en √©toile, justification, avantages</li>
            <li><strong>Processus ETL avec Pentaho</strong> : Description de chaque transformation, captures d'√©cran, logs d'ex√©cution</li>
            <li><strong>Analyses OLAP</strong> : R√©sultats des requ√™tes SQL, interpr√©tation m√©tier</li>
            <li><strong>Visualisations Power BI</strong> : Captures du dashboard, explication de chaque visuel, insights m√©tier</li>
            <li><strong>Conclusions et recommandations</strong> : Synth√®se, apprentissages, am√©liorations possibles</li>
            <li><strong>Annexes</strong> : Scripts complets, logs d'ex√©cution, difficult√©s rencontr√©es</li>
        </ol>

        <div class="note">
            <strong>Conseil :</strong> Prenez des captures d'√©cran √† chaque √©tape importante du TP. Elles seront pr√©cieuses pour illustrer votre rapport et prouver que vous avez effectivement r√©alis√© toutes les √©tapes.
        </div>

        
        
        <hr style="margin: 40px 0; border: none; border-top: 2px solid #1a73e8;">

        <p style="text-align: center; color: #6c757d; font-size: 0.9em;">
            <strong>TP r√©alis√© par :</strong> ahmedamamou<br>
            <strong>Date :</strong> 2025-11-18<br>
            <strong>Version :</strong> 1.0 - TP Complet Pipeline OLTP ‚Üí ETL ‚Üí DWH ‚Üí Power BI
        </p>

    </div>
</body>
</html>